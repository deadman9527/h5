!function(a,b){var c=a.document,d=(a.navigator.userAgent,window.requestAnimationFrame||window.webkitRequestAnimationFrame);proto={init:function(){function a(){if(i.scraping)for(var a=0;a<event.changedTouches.length;a++)b(event.changedTouches[a])}function b(a){function b(b){for(var c,d=0;d<b.changedTouches.length;d++)if(b.changedTouches[d].identifier==a.identifier){c=b.changedTouches[d];break}c&&(k&&m&&h.moveTo(k,m),e(c)&&(k=c.clientX-n.left,m=c.clientY-n.top,h.lineTo(k,m),h.stroke()),j.forceRefresh&&(l.style.opacity=l.style.opacity?"":.999))}function i(d){o=!1;for(var e,h=0;h<d.changedTouches.length;h++)if(d.changedTouches[h].identifier==a.identifier){e=d.changedTouches[h];break}e&&(f()>j.activePercent&&g(),c.removeEventListener("touchmove",b,!1),c.removeEventListener("touchend",i,!1))}var k,m,o=!0;c.addEventListener("touchmove",b,!1),c.addEventListener("touchend",i,!1),e(a)&&(k=a.clientX-n.left,m=a.clientY-n.top),h.beginPath(),d&&j.moveChecking&&d(function(){o&&(f()>j.activePercent?(g(),c.removeEventListener("touchmove",b,!1),c.removeEventListener("touchend",i,!1)):d(arguments.callee))})}function e(a){return a.clientX>n.left&&a.clientX<n.right&&a.clientY>n.top&&a.clientY<n.bottom}function f(){var a,b,c,d,e,f=m.querySelectorAll(".active-el"),g=0,i=0;0===f.length&&(f=m.querySelectorAll("*"));for(var j=0;j<f.length;j++)if(a=f[j].getClientRects()[0]){b=a.left-n.left,c=a.top-n.top,d=a.right-a.left,e=a.bottom-a.top,data=h.getImageData(b,c,d,e).data;for(var k=0;k<data.length;k+=4)g++,0==data[k+3]&&i++}return i/g}function g(){i.scraping=!1,l.style.webkitTransition="opacity 0.6s ease",l.style.opacity=0,setTimeout(function(){l.style.display="none",j.onfinish&&j.onfinish()},600)}var h,i=this,j=i.options,k=i.el="string"==typeof j.el?document.querySelector(j.el):j.el,l=i.canvas=document.createElement("canvas"),m=i.wrap=document.createElement("div"),n=i.region=k.getClientRects()[0];if(k.appendChild(m),k.appendChild(l),k.style.cssText+="position:relative;",l.width=n.right-n.left,l.height=n.bottom-n.top,m.style.cssText="width:100%;height:100%;position:relative;",l.style.cssText="width:"+l.width+"px;height:"+l.height+";position:absolute;top:0;left:0;z-index:9;display:none;",!(h=i.context=l.getContext("2d")))throw new Error("not support context 2d");c.addEventListener("touchstart",a,!1)},replace:function(a){{var b=this,c=b.wrap;b.canvas}if(a instanceof HTMLElement&&(a=[a]),c.style.visibility="hidden","string"==typeof a)c.innerHTML=a;else if(a instanceof Array){c.innerHTML="";for(var d=0;d<a.length;d++)c.appendChild(a[d])}c.style.visibility=""},refresh:function(a){var b=this,c=(b.el,b.wrap),d=b.options,e=b.canvas,f=b.region,g=b.context;a||(a={});for(var h in a)d[h]=a[h];if(c.style.visibility="hidden",e.width=f.right-f.left,g.globalCompositeOperation="source-over",g.fillStyle=d.coverColor,g.fillRect(0,0,f.right-f.left,f.bottom-f.top),d.font){if(g.font=d.font.size+" "+(d.font.family||"serif"),g.fillStyle=d.font.color,"center"===d.font.x||"center"===d.font.y){var i=g.measureText(d.font.text);"center"===d.font.x&&(d.font.x=e.width/2-i.width/2),"center"===d.font.y&&(d.font.y=e.height/2-i.height/2)}g.fillText(d.font.text,d.font.x||0,d.font.y||0)}g.globalCompositeOperation="destination-out",g.lineJoin="round",g.lineCap="round",g.strokeStyle="rgba(0,0,0,255)",g.lineWidth=d.lineWidth||30,e.style.opacity=1,e.style.webkitTransition="",e.style.display="",c.style.visibility="",this.scraping=!0}},b.scrape=function(a){var b=Object.create({});a.activePercent||(a.activePercent=.8),b.options=a;for(var c in proto)b[c]=proto[c];return b.init(),b}}(window,window.lib||(window.lib={}));