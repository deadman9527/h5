!function(a,b){function c(a,b){var c=new h(location.href),d=g.getElementById("buried"),e=c.params.ttid,f=c.params.ad_id,i=c.params.source_type,j=c.params.refpid,k=c.params.actparam,l=c.params.actname,m=c.params.ali_trackid,n=c.params.pid,o=g.cookie.match(/(?:^|\s)cna=([^;]+)(?:;|$)/);c.search="",c.hash="";var p={};if(d&&(e=d.value),p.from="h5",e&&(p.ttid=e),j&&(p.refpid=j),k&&(p.actparam=k),l&&(p.actname=l),p.url=c.toString(),n&&(p.pid=n),f&&(p.ad_id=f),i&&(p.source_type=i),m&&(p.ali_trackid=m),o&&(p.h5_uid=o[1]),"object"==typeof b)for(var q in b)p[q]=b[q];return a.params.point=JSON.stringify(p),a}function d(a,b){var c=new h(location.href),d=g.getElementById("buried");for(var e in c.params)a.params.hasOwnProperty(e)||(a.params[e]=c.params[e]);if(d&&(a.params.ttid=d.value),"object"==typeof b)for(var e in b)a.params[e]=b[e];return a}function e(a){m||(m=g.createElement("iframe"),m.id="callapp_iframe_"+Date.now(),m.frameborder="0",m.style.cssText="display:none;border:0;width:0;height:0;",g.body.appendChild(m)),m.src=a}function f(a,b){b.replace===!1||!j&&b.replace!==!0?location.href=a:location.replace(a)}var g=a.document,h=b.httpurl,i=b.env.os,j=(b.env.params,b.env.aliapp),k=b.env.browser,l={taobao:"com.taobao.taobao",taobaowebview:"com.taobao.taobao",tmall:"com.tmall.wireless"};b.callapp={};var m;b.callapp.gotoPage=function(a,b){b=b||{},"undefined"==typeof b.point&&(b.point=!0),"undefined"==typeof b.params&&(b.params=!0);var g=a||location.href;if(a=new h(a),("http"===a.protocal||"https"===a.protocal)&&(i.isAndroid&&j&&"TB"===j.appname?(a=new h("taobaowebview://m.taobao.com/"),a.params.weburl=g):a.protocal="vecn"),"vecn"===a.protocal)b.point&&c(a,b.point),b.params&&d(a,b.params);else if("taobaowebview"===a.protocal){b.point&&c(a,b.point);var m=new h(a.params.weburl);b.params&&d(m,b.params),b.point&&c(m,b.point),a.params.weburl=m.toString()}else"tmall"!==a.protocal.toUpperCase()&&"kddcpublic"!==a.protocal.toUpperCase()&&b.params&&d(a,b.params);i.isAndroid&&i.version.lt("4.5")&&k.isChrome&&!k.isWebview&&(a.hash="Intent;scheme="+a.protocal+";package="+(b["package"]||l[a.protocal])+";end",a.protocal="intent"),j&&"Apad"!=j.platform||!j&&k.isChrome&&i.isAndroid?setTimeout(function(){f(a.toString(),b)},100):e(a.toString())},b.callapp.download=function(a,b){b=b||{},a||(a=i.isIPhone?"http://itunes.apple.com/cn/app/id387682726?mt=8":i.isIPad?"https://itunes.apple.com/app/id438865278":i.isAndroid?"http://download.taobaocdn.com/wireless/taobao4android/latest/taobao4android_703248.apk":""),a=new h(a),i.isAndroid&&a.pathname.match(/\.apk$/)?(a.search="",a.hash=""):b.params&&d(a,b.params),a=a.toString(),f(a,b)}}(window,window.lib||(window.lib={}));
if (window.KISSY) {KISSY.add('mtb/lib-callapp/1.2.5/callapp.cmd',function() {return window.lib.callapp;},{requries:['mtb/lib-env','mtb/lib-httpurl']});} else if ('undefined' !== typeof define) {define('mtb/lib-callapp/1.2.5/callapp.cmd', [], function(require){require('mtb/lib-env');require('mtb/lib-httpurl');return window.lib.callapp;});}