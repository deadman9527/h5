!function(a,b){function c(a){if(a.products.suxing&&a.products.suxing[0].xxsx.length>1){if(this.evaDialog=new lib.Dialog({boxClass:"#sku-dialog",triggerClass:".sku-trigger",onShow:function(){setTimeout(function(){b(".sku-dialog-box").css("-webkit-transform","translateY(0%)")},100),b(".ve-gotop").hide(),b("body").css("overflow","hidden")},onHide:function(){b(".ve-gotop").show(),b("body").css("overflow","auto")}}),a.products.suxing)var c="1"==a.products.suxing[0].xxsx[0].is_phone_price?a.products.suxing[0].xxsx[0].phone_price:a.products.suxing[0].xxsx[0].current_price;else var c="1"==a.products.is_phone_price?a.products.phone_price:a.products.current_price;var e='<ul id="dia-sku-top">';e+="<li>",e+='<img src="'+a.products.images[0].url+'" width="50">',e+="</li>",e+='<li class="sku-title">',e+="<h1>"+a.products.name+"</h1>",e+="<h2>",e+='<span class="price-big">￥<span id="sku-bigpri">'+c+"</span></span>",e+='<span class="price-small line-through">￥'+a.products.origin_price+"</span>",e+="</h2>",e+="</li>",e+='<li class="float-right pro-cancle">',e+='<img class="sku-cancel" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjAyMEJBRURENzIwQzExRTRBREVGQjY5MjkzOEU1QzdEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjAyMEJBRURFNzIwQzExRTRBREVGQjY5MjkzOEU1QzdEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDIwQkFFREI3MjBDMTFFNEFERUZCNjkyOTM4RTVDN0QiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDIwQkFFREM3MjBDMTFFNEFERUZCNjkyOTM4RTVDN0QiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5pWN6tAAABBklEQVR42sTTzQ3CMAwF4PDENnSfTlMOwBIdoczT7kMsFSmEtPlxbFt6PbxcPqn2ZZ7nxTn38Nmc7dx8JvjP0+e9F5YYMrwItPqMhqgvhgwr9tIK9YOhAsGjNuoPE4M0UUMKkwJpoAizpDBHIEnUKeYMJIHKYnKgnqgiTAmoB6oYUwrioKowNaAWVDWmFlSDasK0gGLU0BPTCgpRS4RiYWiujFMOUePesTBcUIxyXAznl4kNFxTuTGqnVEHxAq89UOiEyV2fKCh32iwUOmPYKAhgWCgIYZpREMQ0oSCMqUZBAVOFghKmGAVFTBEKypgsCgaYUxSMMIcoGGKSKAJNhpgYdf8IMABOUYgZIYoSlgAAAABJRU5ErkJggg==">',e+="</li>",e+="</ul>",b(".pro-sku-top").html(e),b(".sku-cancel").on("click",function(){b(".sku-dialog-box").css("-webkit-transform","translateY(100%)"),setTimeout(function(){b("#sku-dialog").hide(),b("body").css("overflow","auto")},300)});var f="";if(a.products.suxing)for(var g=0;g<a.products.suxing[0].xxsx.length;g++){var h="1"==a.products.suxing[0].xxsx[g].is_phone_price?a.products.suxing[0].xxsx.phone_price:a.products.suxing[0].xxsx[g].current_price;f+='<span barcode="'+a.products.suxing[0].xxsx[g].id+'" current_price="'+h+'" is_stock="'+a.products.suxing[0].xxsx[g].is_stock+'" select="false">'+a.products.suxing[0].xxsx[g].name+"</span>"}var i='<div class="sku-size" id="dia-sku-size"><h1>尺寸：</h1>';i+=f+'</div><div class="sku-count">',i+='<span class="float-left">数量：</span><span class="float-right"><div id="J_Num1" class="num ctrl-number clearfix"><div class="minus J_Minus">-</div>            <input class="J_InputNum input-num" type="number" value="1">            <div class="add J_Add">+</div>    </div></span></div>',i+='<input id="sku-size" type="hidden" val="" value=""><input id="sku-color" type="hidden">',b(".pro-sku-body").html(i);var j=0==parseInt(a.products.user_min_bought)?1:a.products.user_min_bought,k=0==parseInt(a.products.user_max_bought)?999:a.products.user_max_bought;this.number=new ctrl.number({el:"#J_Num1",step:1,quantity:j,min:j,max:k}),a.products.suxing&&a.products.suxing[0].xxsx.length>=1&&(b(".sku-size span:eq(0)").attr("select","true"),b(".sku-size span:eq(0)").css("border",parseInt(b("html").attr("dataset").dpr)+"px solid #ff3862"),b(".sku-size span:eq(0)").css("color","#ff3862"),b("#sku-size").val(a.products.suxing[0].xxsx[0].id)),b(".sku-size span").click(function(){"false"==b(this).attr("select")?(b("#sku-size").val(b(this).attr("barcode")),b(".sku-size span").attr("select","false"),b(".sku-size span").css("border",parseInt(b("html").attr("dataset").dpr)+"px solid #333333"),b(".sku-size span").css("color","#333333"),b(this).attr("select","true"),b(this).css("border",parseInt(b("html").attr("dataset").dpr)+"px solid #ff3862"),b(this).css("color","#ff3862"),b("#sku-bigpri").html(b(this).attr("current_price"))):(b("#sku-size").val(""),b(".sku-size span").css("border",parseInt(b("html").attr("dataset").dpr)+"px solid #333333"),b(".sku-size span").css("color","#333333"),b(".sku-size span").attr("select","false"))}),b(".pro-sku-foot span").click(function(){d(a)})}else b(".sku-trigger").click(function(){d(a)})}function d(a){lib.login.isLogin()||lib.storage.set("accessToken","");var c,d;if(a.products.suxing&&a.products.suxing[0].xxsx.length>1)c=b("#sku-size").val(),d=b(this.number.$inputNum).attr("valueAsNumber");else if(a.products.suxing){c=a.products.suxing[0].xxsx[0].id;try{d="0"==a.products.suxing[0].xxsx[0].user_min_bought?1:a.products.suxing[0].xxsx[0].user_min_bought,d||(d="0"==a.products.user_min_bought?1:a.products.user_min_bought)}catch(e){d="0"==a.products.user_min_bought?1:a.products.user_min_bought}}else c="",d="0"==a.products.user_min_bought?1:a.products.user_min_bought;var f=this;if(f.data=a,!f.skusure_isAjax){f.goodsNumber=d?d:b(this.number.$inputNum).attr("valueAsNumber"),f.skusure_isAjax=!0;var g={attr:c,user_min_bought:null,free_ship:null,user_max_bought:null,img:null,imgurl:null,isSelect:!0,suxing:null,itemid:null,nofree_ship_info:null,sourceId:null,source:null,settle:null,promotions:null,product_name:null,productid:this.productId,price:0,origin_price:0,position:0,num:d,is_stock:0,gift:!1,decrease:!1};console.log("["+JSON.stringify(g)+"]"),lib.api.get({api:{c:"shoping",a:"addtocart"},data:{json:"["+JSON.stringify(g)+"]",accessToken:lib.storage.get("accessToken"),buy_now:1},success:function(a){console.log(a),lib.h5log.log(["setCustomVariable",4,"goodsNumber",f.goodsNumber,"page"]),null!=c&&d&&(lib.login.isLogin()?0==f.data.products.is_sea_label?setTimeout(function(){location.href="http://h5.ve.cn/order-confirm.html"},50):setTimeout(function(){location.href="http://h5.ve.cn/order-confirm.html?proType=1"},50):0==f.data.products.is_sea_label?setTimeout(function(){location.href="http://h5.ve.cn/direct-order-confirm.html?cartId="+a.cart_id},50):setTimeout(function(){location.href="http://h5.ve.cn/direct-order-confirm.html?proType=1&cartId="+a.cart_id},50))},error:function(a){if(a&&""!=a.desc)var b=a.desc;else b="服务器开小差啦";alert(b)},complete:function(){f.skusure_isAjax=!1}})}}this.productId=b("#sku").attr("pid"),this.brandId=null;lib.api.get({api:{c:"deal",a:"detail"},data:{productId:this.productId},success:function(a){console.log(a),c(a)},error:function(a){console.log(a)},complete:function(){}})}(this,Zepto);