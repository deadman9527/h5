!function(win,lib){function extend(target,source,isOverWrite){void 0==isOverWrite&&(isOverWrite=!0);for(var k in source)k in target&&!isOverWrite||(target[k]=source[k]);return target}lib||(window.lib={}),lib=window.lib;var _getUid=function(){var id=0;return function(){return id++}}();lib.AMap=function(params){var _config={lon:116.404,lat:39.915,autoPosition:!0};this._cfg=extend(_config,params),this.mapObj=new AMap.Map(this._cfg.container,{center:new AMap.LngLat(this._cfg.lon,this._cfg.lat)}),this._initDefaultPlugins()},lib.AMap.prototype={_initDefaultPlugins:function(){var mapObj=this.mapObj,_cfg=this._cfg;this.markers=[],mapObj.plugin(["AMap.ToolBar","AMap.Scale"],function(){tool=new AMap.ToolBar({direction:!0,ruler:!0,autoPosition:_cfg.autoPosition}),mapObj.addControl(tool),scale=new AMap.Scale,mapObj.addControl(scale)})},getCenter:function(){var o=this.mapObj.getCenter();return{lon:o.getLng(),lat:o.getLat()}},setCenter:function(lon,lat){var pos=new AMap.LngLat(lon,lat);return this.mapObj.setCenter(pos),this},getZoom:function(){return this.mapObj.getZoom()},setZoom:function(lv){return lv=Math.max(Math.min(18,parseInt(lv)),3),this.mapObj.setZoom(lv),this},getScale:function(){return this.mapObj.getScale()},moveTo:function(lon,lat){var pos=new AMap.LngLat(lon,lat);return this.mapObj.panTo(pos),this},addLayer:function(params){void 0==params.id&&(params.id=_getUid()),params.offset||(params.offset=[0,0]);var marker=new AMap.Marker({map:this.mapObj,position:new AMap.LngLat(params.lon,params.lat),offset:new AMap.Pixel(params.offset[0],params.offset[1]),content:params.content});return marker.id=params.id,this.markers.push(marker),this},getLayer:function(id){for(var i=0;i<this.markers.length;i++)if(id===this.markers[i].id)return this.markers[i];return null},removeLayer:function(id){for(var i=0;i<this.markers.length;i++)if(id===this.markers[i].id)return this.markers[i].hide(),this.markers[i]=null,this.markers.splice(i,1)},destory:function(){return this.mapObj.destory()}}}(window,window.lib);