!function(a){var b={init:function(){this.addEvents(),this.transmit(),this.topbar=new ctrl.topBar({isIndex:!1}),this.bottombar=new ctrl.bottomBar({showBottom:!0,showApp:!1,showCircle:!1})},addEvents:function(){var b=this;a("#submit").on("click",function(){b.submit()}),a("#login-alipay").on("click",function(){a(this).attr("href","http://localhost/alipay/alipayapi.php").trigger("click")})},transmit:function(){var b=new lib.httpurl(location.href),c=b.params;c.redirectUrl=c.redirectUrl?c.redirectUrl:"";var d=location.href.indexOf("http://h5.ve.cn")>-1,e="",f="";if(d){if(e=c.redirectUrl?"http://h5.ve.cn/getpassword.html?redirectUrl="+encodeURIComponent(c.redirectUrl):"http://h5.ve.cn/getpassword.html",a("#forget").attr("href",e),c.redirectUrl.indexOf("cartfrom")>=0){var g=c.redirectUrl.indexOf("proType=1")>=0?1:0;f=c.redirectUrl?"http://h5.ve.cn/register.html?redirectUrl=order-confirm.html%3FproType%3D"+g:"http://h5.ve.cn/register.html"}else f=c.redirectUrl?"http://h5.ve.cn/register.html?redirectUrl="+encodeURIComponent(c.redirectUrl):"http://h5.ve.cn/register.html";a("#register").attr("href",f)}else{if(e=c.redirectUrl?"getpassword.html?redirectUrl="+encodeURIComponent(c.redirectUrl):"getpassword.html",a("#forget").attr("href",e),c.redirectUrl.indexOf("cartfrom")>=0){var g=c.redirectUrl.indexOf("proType=1")>=0?1:0;f=c.redirectUrl?"register.html?redirectUrl=order-confirm.html%3FproType%3D"+g:"register.html"}else f=c.redirectUrl?"register.html?redirectUrl="+encodeURIComponent(c.redirectUrl):"register.html";a("#register").attr("href",f)}a("#login-sina").on("click",function(){lib.storage.set("CallBackUrl",encodeURIComponent(c.redirectUrl)),location.href="https://api.weibo.com/oauth2/authorize?client_id=2441162563&redirect_uri=http%3A%2F%2Ftest.h5.ve.cn%2Fthirdlogin%2Fcallback.php&response_type=code"}),a("#qq_login_btn").on("click",function(){lib.storage.set("CallBackUrl",encodeURIComponent(c.redirectUrl));var a="http://test.h5.ve.cn/thirdlogin/qqindex.php";location.href=a})},submit:function(){var a=this;a.isAjax||this.verify("tel")&&(a.isAjax=!0,lib.md5&&(this.password=lib.md5(this.password)),lib.api.get({api:{c:"user",a:"login"},data:{phone:this.username,password:this.password},success:function(a){lib.h5log.log(["setCustomVariable",1,"userId",a.user.userId,"visit"]);var b=null;console.log(a);try{lib.storage.set("guideFilter",a.user.filter)}catch(c){}lib.login.login(a,b)},error:function(a){a&&a.desc&&alert(a.desc),console.error(a)},complete:function(){a.isAjax=!1}}))},verify:function(){if(this.username=a("#username").val(),this.password=a("#password").val(),/^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/.test(this.username));else if(!/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/.test(this.username))return alert("用户名不正确，请重新输入！"),!1;return 0==this.password.length?(alert("密码不能为空"),!1):!0}};a(function(){b.init()})}(Zepto);