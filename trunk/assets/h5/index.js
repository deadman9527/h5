!function(a,b){function c(a,b){if(g={},g[a])return void b(g[a]);var c=[];if(1==a){for(var d=0;d<parseInt(endDates[0])-parseInt(startDates[0])+1;d++){var e=new Object;e.name=d+parseInt(startDates[0])+"年",e.id=d+2,c.push(e)}b(c),g[a]=c}if(a>=2&&19>=a){if(endDates[0]==startDates[0]){j=!0;for(var d=parseInt(startDates[1])-1;d<parseInt(endDates[1]);d++){var e=new Object;e.name=d+1+"月",e.id=d+21,c.push(e)}}else if(2==a){j=!1;for(var d=parseInt(startDates[1])-1;12>d;d++){var e=new Object;e.name=d+1+"月",e.id=d+21,c.push(e)}}else if(a==2+parseInt(endDates[0])-parseInt(startDates[0])){console.log("lastYear"),j=!0;for(var d=0;d<parseInt(endDates[1]);d++){var e=new Object;e.name=d+1+"月",e.id=d+21,c.push(e)}}else{j=!1;for(var d=0;12>d;d++){var e=new Object;e.name=d+1+"月",e.id=d+21,c.push(e)}}b(c),g[a]=c}if(a>=21&&32>=a){var f=30;if(22==a?f=28:(21==a||23==a||25==a||27==a||28==a||30==a||32==a)&&(f=31),endDates[0]==startDates[0])if(21==a)for(var d=parseInt(startDates[2])-1;f>d;d++){var e=new Object;e.name=d+1+"日",e.id=d+41,c.push(e)}else if(a==21+parseInt(endDates[1])-parseInt(startDates[1]))for(var d=0;d<parseInt(endDates[2]);d++){var e=new Object;e.name=d+1+"日",e.id=d+41,c.push(e)}else for(var d=0;f>d;d++){var e=new Object;e.name=d+1+"日",e.id=d+41,c.push(e)}else if(j&&a==21+parseInt(endDates[1])-parseInt(startDates[1]))for(var d=0;d<parseInt(endDates[2]);d++){var e=new Object;e.name=d+1+"日",e.id=d+41,c.push(e)}else if(21!=a||j)for(var d=0;f>d;d++){var e=new Object;e.name=d+1+"日",e.id=d+41,c.push(e)}else for(var d=parseInt(startDates[2])-1;f>d;d++){var e=new Object;e.name=d+1+"日",e.id=d+41,c.push(e)}b(c),g[a]=c}}function d(a){var b={},d={},e=a.id||1,f=a.deep||3,g=a.onReady,j={3:"year",2:"month",1:"day"};h=a.startDate||h,i=a.endDate||i,startDates=h.split("-"),endDates=i.split("-"),c(e,function(a){var e=j[f];d[e]=[],a.forEach(function(a,c){var f={key:a.name,value:a.id,selected:0===c};d[e].push(f),0===c&&(b[e]=f)}),f--,1>f?g&&g(d):c(b[e].value,arguments.callee)})}function e(a,b){b=b||{};var c=ctrl.selectmenu;f=new c({confirmText:b.confirmText||"确定",title:b.title||"",cancelText:b.opts||"取消",trigger:b.trigger}),f.viewModel=a,f.addEventListener("confirm",function(){b.onConfirm(this.selectedValue)}),f.addEventListener("select",function(a){var b=this.selectedValue["val-"+a],c=this;"year"==a?d({id:b,deep:2,onReady:function(a){c.linkage("month",a.month),c.linkage("day",a.day)}}):"month"==a&&d({id:b,deep:1,onReady:function(a){c.linkage("day",a.day)}})}),b.appendDom?b.appendDom.appendChild(f.root):document.body.appendChild(f.root)}var f,g={},h="2010-1-1",i="2016-1-1",j=!1;b.selectAddress={init:function(a){console.log(a),d({onReady:function(b){e(b,a)},startDate:a.startDate,endDate:a.endDate})}}}(Zepto,window.app||(window.app={})),function(a,b){function c(a,b){if(g={},g[a])return void b(g[a]);var c=[];if(1==a){for(var d=0;d<parseInt(endDates[0])-parseInt(startDates[0])+1;d++){var e=new Object;e.name=d+parseInt(startDates[0])+"年",e.id=d+2,c.push(e)}b(c),g[a]=c}if(a>=2&&19>=a){if(endDates[0]==startDates[0]){j=!0;for(var d=parseInt(startDates[1])-1;d<parseInt(endDates[1]);d++){var e=new Object;e.name=d+1+"月",e.id=d+21,c.push(e)}}else if(2==a){j=!1;for(var d=parseInt(startDates[1])-1;12>d;d++){var e=new Object;e.name=d+1+"月",e.id=d+21,c.push(e)}}else if(a==2+parseInt(endDates[0])-parseInt(startDates[0])){console.log("lastYear"),j=!0;for(var d=0;d<parseInt(endDates[1]);d++){var e=new Object;e.name=d+1+"月",e.id=d+21,c.push(e)}}else{j=!1;for(var d=0;12>d;d++){var e=new Object;e.name=d+1+"月",e.id=d+21,c.push(e)}}b(c),g[a]=c}if(a>=21&&32>=a){var f=30;if(22==a?f=28:(21==a||23==a||25==a||27==a||28==a||30==a||32==a)&&(f=31),endDates[0]==startDates[0])if(21==a)for(var d=parseInt(startDates[2])-1;f>d;d++){var e=new Object;e.name=d+1+"日",e.id=d+41,c.push(e)}else if(a==21+parseInt(endDates[1])-parseInt(startDates[1]))for(var d=0;d<parseInt(endDates[2]);d++){var e=new Object;e.name=d+1+"日",e.id=d+41,c.push(e)}else for(var d=0;f>d;d++){var e=new Object;e.name=d+1+"日",e.id=d+41,c.push(e)}else if(j&&a==21+parseInt(endDates[1])-parseInt(startDates[1]))for(var d=0;d<parseInt(endDates[2]);d++){var e=new Object;e.name=d+1+"日",e.id=d+41,c.push(e)}else if(21!=a||j)for(var d=0;f>d;d++){var e=new Object;e.name=d+1+"日",e.id=d+41,c.push(e)}else for(var d=parseInt(startDates[2])-1;f>d;d++){var e=new Object;e.name=d+1+"日",e.id=d+41,c.push(e)}b(c),g[a]=c}}function d(a){var b={},d={},e=a.id||1,f=a.deep||3,g=a.onReady,j={3:"year",2:"month",1:"day"};h=a.startDate||h,i=a.endDate||i,startDates=h.split("-"),endDates=i.split("-"),c(e,function(a){var e=j[f];d[e]=[],a.forEach(function(a,c){var f={key:a.name,value:a.id,selected:0===c};d[e].push(f),0===c&&(b[e]=f)}),f--,1>f?g&&g(d):c(b[e].value,arguments.callee)})}function e(a,b){b=b||{};var c=ctrl.selectmenu;f=new c({confirmText:b.confirmText||"确定",title:b.title||"",cancelText:b.opts||"取消",trigger:b.trigger}),f.viewModel=a,f.addEventListener("confirm",function(){b.onConfirm(this.selectedValue)}),f.addEventListener("select",function(a){var b=this.selectedValue["val-"+a],c=this;"year"==a?d({id:b,deep:2,onReady:function(a){c.linkage("month",a.month),c.linkage("day",a.day)}}):"month"==a&&d({id:b,deep:1,onReady:function(a){c.linkage("day",a.day)}})}),b.appendDom?b.appendDom.appendChild(f.root):document.body.appendChild(f.root)}var f,g={},h="2010-1-1",i="2016-1-1",j=!1;b.selectAddress={init:function(a){console.log(a),d({onReady:function(b){e(b,a)},startDate:a.startDate,endDate:a.endDate})}}}(Zepto,window.app2||(window.app2={})),function(a,b){function c(a,b){var a=a||"2015-03-21 00:00:00",b=b,c=a.replace(/-/g,"/"),d=new Date(c),e=d.getTime().toString(),f=a.substring(0,10).split("-");a=f[1]+"-"+f[2]+"-"+f[0]+" "+a.substring(10,19);var g=(b-e)/3600/1e3;return 0>g?!1:g>0?!0:0==g?!1:!1}var d=new Date,e=d.getDate(),f=d.getMonth()+1,g=d.getFullYear(),h=new Date((new Date).getTime()+2592e7),i=(h.getDate(),h.getMonth()+1),j=h.getFullYear(),k=window.navigator.userAgent.toLowerCase();SEMURL=k.match(/MobileVecn/i)?!1:!0,b.formatImgSrc=function(a){var b=a.match(/^http:\/\/img\.ve\.cnttp(.+)_3\.jpg/);return b?"http"+b[1]+".jpg":a},b.formatTitleLink=function(a,b,c){var d=new lib.httpurl(a);d.params.title=b?b:"";var e=d.toString().replace("http://h5.ve.cn/",""),f="http://"+location.host,g=c?c:"",h=new lib.httpurl(f+"/"+g+"brandcate-"+d.params.brandId+".html");h.params.brandId=d.params.brandId,h.params.title=b?b:"";var i=h.toString(),j=SEMURL?i:e;return j};var l,m=document.documentElement,n={init:function(b){if(register_r?lib.storage.set("register_r",register_r):lib.storage.set("register_r",null),lib.storage.get("register_real"))this.renderFlash();else{l=a(document).width(),a(".realPropagation").show(),lib.storage.set("register_real",!0);var c=a(".realPropagation")[0];c.addEventListener("click",function(){a(".realPropagation").hide()})}var d=new lib.httpurl(location.href),e=d.params.pid?d.params.pid:"";lib.storage.set("pid",e),new lib.goTop,this.topbar=new ctrl.topBar({isIndex:!0}),a("body").prepend('<div class="bottomdown"><span class="close-down"></span><img id="downapp" src="http://img01.ve.cn/party/f07a403d1f73dd32709bdd40113da56d.jpg" /></div>'),a(".topbar").css("position","relative"),a("body").css("padding-top","0px"),a(".close-down").click(function(){a(".bottomdown").remove()}),a("#downapp").on("click",function(){var a="http://h5.ve.cn/index.html",b=!0,c=!0;lib.callapp.gotoPage(a,{point:c,params:b})}),console.log(ctrl.topBar.getInfo().height),ctrl.topBar&&ctrl.topBar.getInfo&&(a("#target-fix")[0].style.top=-ctrl.topBar.getInfo().height||"0px"),this.opts=b,l=m.getBoundingClientRect().width,this.page=1,this.guideId="",this.cd=[],lib.lazyload.init();var f=this;this.infiniteScroll=lib.infiniteScroll.init({bufferPx:200,time:100,onNear:function(){f.loadBrands()},end:function(){return f.isEnd},onEnd:function(){f.hideTip("加载已完成!")},onScroll:function(){f.showTip("努力加载中...")}}),f.renderBottomBar(),this.render(0)},renderFlash:function(){var b=new Date;c(null,b.getTime()),a.ajax({url:"http://act.ve.cn/data/indexflash.json",data:{},dataType:"json",success:function(d){var d=d.data;lib.storage.get("indexFlash")||lib.storage.set("indexFlash",[]);var e=lib.storage.get("indexFlash"),f=!1;if(d.length>0){for(var g=0;g<d.length;g++){if(e.length>0){for(var h in e)if(d[g].id==e[h]){f=!0;break}}else{if(c(d[g].startDate,b.getTime())&&!c(d[g].endDate,b.getTime())){a("body").append('<div class="flashbg"></div>'),e.push(d[g].id),lib.storage.set("indexFlash",e),d[g].color?a(".flashbg").css("background","#"+d[g].color):a(".flashbg").css("background","#ff3862"),a(".flashbg").html('<span class="close" id="flash-close" ></span><a href="'+d[g].targetUrl+'"><div class="flash lazy" id="flash" dataimg="'+d[g].img+'" > </div></a>'),f=!1;break}f=!0}if(f)break}f?(a(".flashbg").hide(),a("body").css("overflow","auto")):(a(".flashbg").show(),a("body").css("overflow","hidden"),a("#flash-close").on("click",function(){a(".flashbg").hide(),a("body").css("overflow","auto")}),lib.lazyload.trigger(),setTimeout(function(){a(".flashbg").remove()},5e3))}},error:function(){},complete:function(){}})},renderBottomBar:function(){this.bottombar=new ctrl.bottomBar({hoverIndex:0,showBottom:!0,showApp:!1,showCircle:!1}),a("#callApp").on("click",function(){var a="http://h5.ve.cn/index.html",b=!0,c=!0;lib.callapp.gotoPage(a,{point:c,params:b})})},renderAge:function(){var b=this;a(".guide-status span").on("click",function(){a("#guide").hide(),lib.storage.set("guideOver",1),b.renderBottomBar(),b.render(0),b.topbar.setIndexName(imgdom+"我的定制")}),a(".guide-main a").on("click",function(){b.guideType=parseInt(a(this).attr("guideType"))}),this.renderGuide()},renderGuide:function(){var a=this;app.selectAddress.init({confirmText:"",title:"出生日期",cancelText:"",startDate:"2001-1-1",endDate:g+"-"+f+"-"+e,trigger:document.getElementsByClassName("guideA"),appendDom:document.getElementById("guide"),onConfirm:function(b){var c=parseInt(b["key-day"]),d=parseInt(b["key-month"]),h=parseInt(b["key-year"]),i=a.guideType||1,j=h+"-"+d+"-"+c,k=0;k=e>=c&&f>=d?g-h:g-h-1,a.selectTime(j,i,k)}}),app2.selectAddress.init({confirmText:"",title:"预产期",cancelText:"",startDate:g+"-"+f+"-"+e,endDate:j+"-"+i+"-"+e,trigger:document.querySelector("#guideB"),appendDom:document.getElementById("guide"),onConfirm:function(b){var c=parseInt(b["key-day"]),d=parseInt(b["key-month"]),h=parseInt(b["key-year"]),i=a.guideType||1,j=h+"-"+d+"-"+c,k=0;k=e>=c&&f>=d?g-h:g-h-1,a.selectTime(j,i,k)}})},selectTime:function(a,b,c){lib.login.isLogin()?lib.api.get({needLogin:!0,api:{c:"user",a:"loadbaby"},data:{sex:b,birthday:a},success:function(a){lib.storage.set("guideFilter",parseInt(a.data.filter)),location.reload()},error:function(){data&&data.desc&&(console.log(data.desc),lib.notification.alert(data.desc,function(){this.hide()}).show())},complete:function(){}}):(lib.storage.set("guideBirthday",a),lib.storage.set("guideBabytype",b),this.renderGuideOld(c))},renderGuideOld:function(a){var b=this;b.filter=3==b.guideType?2:2==b.guideType?a>6?5:a>=3&&6>=a?3:1:a>6?4:a>=3&&6>=a?3:1,lib.storage.set("guideFilter",b.filter),location.reload()},addEvents:function(){var b=this;a(".top-back").on("click",function(){location.href="agefilter.html"}),lib.login.isLogin()?a(".agefilter a").on("click",function(){a(".agefilter").hide(),b.topbar.setIndexName(a(this).attr("name")),b.render(a(this).attr("filter"))}):a(".agefilter a").on("click",function(){a(".agefilter").hide(),b.topbar.setIndexName(a(this).attr("name")),b.render(a(this).attr("filter"))})},render:function(a){this.renderMain(a),this.renderRush()},renderMain:function(a){var b=this;b.isAjax||(b.isAjax=!0,lib.api.get({api:{c:"main",a:""},data:{filter:a},success:function(a){if(!a.data)return void b.renderError("network");var a=a.data,c=a.banner||[];c=b.opts.banner?c.concat(b.opts.banner):c,a.banner&&b.renderSlide(c),a.icon&&b.renderNav(a.icon),a.adv&&b.renderCard(a.adv),a.hot&&b.renderRush(a.hot),a.guide&&b.renderTabheader(a.guide),lib.lazyload.trigger()},error:function(){b.renderError("network")},complete:function(){b.isAjax=!1}}))},renderTabheader:function(b){var c=this;c.guideId=b[0].guideId,this.loadBrands();var d=new ctrl.tabheader;document.getElementsByClassName("brand-menus")[0].appendChild(d.root),d.viewModel={content:b,bottom:!1,top:!0,hasMore:!0,colNumber:3},d.addEventListener("select",function(a){for(var b=0;b<c.cd.length;b++)c.cd[b].stop();c.guideId=a.selected.guideId,c.loadBrands(!0)},!0),a(".brand-menus").css("top","0px")},renderSlide:function(b){var c=a("#slides"),d=a("#tpl-slides").html();c.html(_.template(d)({itemList:b,w:l})),this.slider=new lib.Slider(".slider-box",{loop:!0,play:!0,trigger:".slider-status"})},renderNav:function(b){var c=a("#cate-navs"),d=a("#tpl-cate-navs").html();c.html(_.template(d)({itemList:b}))},renderRush:function(b){var c=a("#rush"),d=a("#tpl-rush").html();c.html(_.template(d)({itemList:b}))},renderCard:function(b){var c=a("#cards"),d=a("#tpl-cards").html();c.html(_.template(d)({itemList:b}))},loadBrands:function(b){var c=this;if(b)c.page=1;else if(c.isAjaxBrands)return;c.isAjaxBrands=!0,lib.api.get({api:{c:"brand",a:"",guideId:c.guideId||""},data:{page:this.page},success:function(d){if(d.data){var d=d.data;c.page>=d.total_page?c.infiniteScroll.triggerEnd():(c.page++,!c.infiniteScroll.started&&c.infiniteScroll.start()),d.brand&&c.renderBrands(d.brand,b),b&&a("#target-fix")[0].scrollIntoView()}},error:function(){},complete:function(){c.isAjaxBrands=!1}})},renderBrands:function(b,c){var d=this,e=a(".item").length;d.existTimeNumber=c?0:e,a(".info-tip").hide();var f=a("#items"),g=a("#tpl-items").html();f[c?"html":"append"](_.template(g)({itemList:b,existNumber:e}));for(var h=b,i=0;i<h.length;i++)if(h[i]&&h[i].time_end){var j=parseInt(h[i].surplusTime),k=Math.floor(j/86400),l=Math.floor((j-24*k*3600)/3600),m=Math.floor((j-24*k*3600-3600*l)/60),n=Math.floor(j-24*k*3600-3600*l-60*m),o=Number(h[i].targetUrl.match(/brandId=\d+/)[0].match(/\d+/)[0]),p=[k,l,m,n];d.renderTime(p,i,o)}lib.lazyload.trigger()},renderTime:function(b,c,d){var e=this,f=3600*parseInt(b[0])*24+3600*parseInt(b[1])+parseInt(60*b[2])+parseInt(10*b[3])/10;f>0?(e.cd[c+e.existTimeNumber]=lib.countdown({endDate:"+"+f.toString(),stringFormatter:b[0]>0?"d天hh小时mm分ss秒":b[1]>0?"hh小时mm分ss秒":b[2]>0?"mm分ss秒":"ss秒",interval:1e3,onUpdate:function(b){a(".b_"+d).html("还剩："+b.stringValue)},onEnd:function(){console.log("cd["+c+"] ended")}}).start(),a(".time-end").show()):a(".time-end").remove()},renderError:function(a){switch(a){case"param":this.showTip("参数请求错误");break;case"network":this.showTip("服务器开小差啦");break;case"empty":this.showTip("当前条件，数据为空")}},showTip:function(b){var c=a("#info-tip");c.html(b).show()},hideTip:function(b){var c=a("#info-tip");b?(c.html("加载已完毕").show(),setTimeout(function(){c.hide()},5e3)):c.hide()}};a(function(){n.init({banner:[]})})}(Zepto,window.Global||(window.Global={}));