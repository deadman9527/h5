!function(a){var b={init:function(){var b=new lib.httpurl(location.href),c=b.params,d=c.title?decodeURIComponent(c.title):"选择地址";document.title=d,new ctrl.topBar({isIndex:!1,title:d}),this.is_select=c.is_select||0,this.proType=c.proType||0,this.is_select&&a(".add-address").attr("href","address-add.html?toConfirm=1&proType="+this.proType),lib.lazyload.init(),this.render(),new lib.goTop},addEvents:function(){var b=this;a(".save-btn").on("click",function(){lib.storage.set("addressSelectedId",a(".active").closest(".address-container").attr("data-id")),window.location.href="order-confirm.html"+(b.proType?"?proType=1":"")})},addEventsSelect:function(){var b=this;a(".address-container").on("click",function(){if(b.is_select)a(this).find(".active").length||(a(".active").remove(),a(this).append('<span class="active"></span>'),lib.storage.set("addressSelectedId",a(".active").closest(".address-container").attr("data-id")),setTimeout(function(){window.location.href="order-confirm.html"+(b.proType?"?proType=1":"")},500),a(".address-container").unbind("click"));else{var c=a(this).index();lib.storage.set("editAddressData",b.addressData[c]),window.location.href="address-add.html?title=编辑地址"}})},render:function(){var a=this;a.isAjax||(a.isAjax=!0,lib.api.get({needLogin:!0,api:{c:"user",a:"getaddress"},data:{},success:function(b){console.log(b),a.addressData=b.addresses,a.renderAddress(b),a.addEventsSelect(),a.addEvents()},error:function(a){if("00007"!=a.code){var b=lib.notification.alert(a.desc,function(){this.hide()},{useTap:!0});b.show()}},complete:function(){a.isAjax=!1}}))},checkNeedScroll:function(){return!this.is_have},renderAddress:function(b){var c=a("#addresses"),d=a("#tpl-address").html();c.append(_.template(d)({data:b,is_select:this.is_select}))},renderSaveBtn:function(){var b=a(".main"),c=a("#tpl-save-btn").html();b.append(_.template(c)({is_select:this.is_select}))},renderError:function(a){switch(a){case"param":this.showTip("缺少必要参数");break;case"network":this.showTip("服务器开小差啦");break;case"empty":this.showTip("当前条件，列表为空")}},showTip:function(b){var c=a(".info-tip");c.html(b).show()}};a(function(){b.init()})}(Zepto,window.Global||(window.Global={}));