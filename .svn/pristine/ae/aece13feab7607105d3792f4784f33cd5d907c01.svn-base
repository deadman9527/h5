!function(e){var r={init:function(){this.addEvents(),this.transmit(),this.topbar=new ctrl.topBar({isIndex:!1}),this.bottombar=new ctrl.bottomBar({showBottom:!0,showApp:!1,showCircle:!1})},addEvents:function(){var r=this;e("#submit").on("click",function(){r.submit()}),e("#login-alipay").on("click",function(){e(this).attr("href","http://localhost/alipay/alipayapi.php").trigger("click")})},transmit:function(){var r=new lib.httpurl(location.href),t=r.params;t.redirectUrl=t.redirectUrl?t.redirectUrl:"";var i=location.href.indexOf("http://h5.quxiu.me")>-1,o="",l="";if(i){if(o=t.redirectUrl?"http://h5.quxiu.me/getpassword.html?redirectUrl="+encodeURIComponent(t.redirectUrl):"http://h5.quxiu.me/getpassword.html",e("#forget").attr("href",o),t.redirectUrl.indexOf("cartfrom")>=0){var s=t.redirectUrl.indexOf("proType=1")>=0?1:0;l=t.redirectUrl?"http://h5.quxiu.me/register.html?redirectUrl=order-confirm.html%3FproType%3D"+s:"http://h5.quxiu.me/register.html"}else l=t.redirectUrl?"http://h5.quxiu.me/register.html?redirectUrl="+encodeURIComponent(t.redirectUrl):"http://h5.quxiu.me/register.html";e("#register").attr("href",l)}else{if(o=t.redirectUrl?"getpassword.html?redirectUrl="+encodeURIComponent(t.redirectUrl):"getpassword.html",e("#forget").attr("href",o),t.redirectUrl.indexOf("cartfrom")>=0){var s=t.redirectUrl.indexOf("proType=1")>=0?1:0;l=t.redirectUrl?"register.html?redirectUrl=order-confirm.html%3FproType%3D"+s:"register.html"}else l=t.redirectUrl?"register.html?redirectUrl="+encodeURIComponent(t.redirectUrl):"register.html";e("#register").attr("href",l)}e("#login-sina").on("click",function(){lib.storage.set("CallBackUrl",encodeURIComponent(t.redirectUrl)),location.href="https://api.weibo.com/oauth2/authorize?client_id=2441162563&redirect_uri=http%3A%2F%2Ftest.h5.quxiu.me%2Fthirdlogin%2Fcallback.php&response_type=code"}),e("#qq_login_btn").on("click",function(){lib.storage.set("CallBackUrl",encodeURIComponent(t.redirectUrl));var e="http://test.h5.quxiu.me/thirdlogin/qqindex.php";location.href=e})},submit:function(){var e=this;e.isAjax||this.verify("tel")&&(e.isAjax=!0,lib.md5&&(this.password=lib.md5(this.password)),lib.api.get({api:{c:"user",a:"login"},data:{phone:this.username,password:this.password},success:function(e){lib.h5log.log(["setCustomVariable",1,"userId",e.user.userId,"visit"]);var r=null;console.log(e);try{lib.storage.set("guideFilter",e.user.filter)}catch(t){}lib.login.login(e,r)},error:function(e){e&&e.desc&&alert(e.desc),console.error(e)},complete:function(){e.isAjax=!1}}))},verify:function(){if(this.username=e("#username").val(),this.password=e("#password").val(),/^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/.test(this.username));else if(!/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/.test(this.username))return alert("用户名不正确，请重新输入！"),!1;return 0==this.password.length?(alert("密码不能为空"),!1):!0}};e(function(){r.init()})}(Zepto);