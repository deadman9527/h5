!function(e,t){function n(e,t){function n(){var t;switch(h){case"column":t=new Array(m+1).join('<div class="column" style="margin-right:'+f+'px;-webkit-box-flex:1;"></div>');break;case"adaptive":var n=Math.floor((e.getBoundingClientRect().width+f)/(s+f));t=new Array(n+1).join('<div class="column" style="width:'+s+"px;margin-right:"+f+'px;"></div>');break;case"fix":t=new Array(m+1).join('<div class="column" style="width:'+s+"px;margin-right:"+f+'px;"></div>')}c.innerHTML=t,c.style.height="",w=Array.prototype.slice.call(c.querySelectorAll(".column")).map(function(e){return e.height=0,e.items={},e.fragment=document.createDocumentFragment(),e})}function i(e){for(var t=w[0],n=t.height,r=1;r<w.length;r++){var i=w[r].height||0;n>i&&(t=w[r],n=i)}var o=t.fragment;e.style.webkitTransform="translateY("+t.height+"px)",o.appendChild(e),e.height||t.appendChild(o),t.height=(t.height||0)+(e.height||e.getBoundingClientRect().height)+g}function o(){for(;p<v.length;p++){var e=v[p],t=document.createElement("div");t.className="item",e.width&&(t.width=e.width,t.style.width=e.width+"px"),e.height&&(t.height=e.height,t.style.height=e.height+"px"),t.innerHTML=e.html,i(t)}for(var n=0,r=0;r<w.length;r++)w[r].fragment&&w[r].fragment.childElementCount&&w[r].appendChild(w[r].fragment),n=Math.max(n,w[r].height);c.style.height=n+"px"}var a=this,l=Date.now()+"-"+ ++r,d=document.createDocumentFragment();1!==arguments.length||arguments[0]instanceof HTMLElement||(t=arguments[0],e=null),e||(e=document.createElement("div"),d.appendChild(e)),t=t||{},e.setAttribute("data-ctrl-name","waterfall"),e.setAttribute("data-ctrl-id",l);var c=document.createElement("div");c.className="column-wrap",e.appendChild(c);var h,u=!0;Object.defineProperty(this,"mode",{get:function(){return h},set:function(e){if(["column","adaptive","fix"].indexOf(e)<0)throw new Error("Non expected value");h!==e&&(u=!0,h=e)}}),this.mode=t.mode||"column";var s;Object.defineProperty(this,"columnWidth",{get:function(){var e=c.querySelector(".column");return e?e.getBoundingClientRect().width:s||0},set:function(e){if("string"==typeof e){var t=parseInt(e);if(!t)throw new Error("Non expected value");s=t}else{if("number"!=typeof e)throw new Error("Non expected value");s=e}}}),t.columnWidth&&(this.columnWidth=t.columnWidth);var m;Object.defineProperty(this,"columnAmount",{get:function(){var e=c.querySelectorAll(".column");return e&&e.length?e.length:m||0},set:function(e){if("string"==typeof e){var t=parseInt(e);if(!t)throw new Error("Non expected value");m=t}else{if("number"!=typeof e)throw new Error("Non expected value");m=e}}}),t.columnAmount&&(this.columnAmount=t.columnAmount);var f;Object.defineProperty(this,"columnPadding",{get:function(){return f},set:function(e){if("string"==typeof e){var t=parseInt(e);if(!t)throw new Error("Non expected value");f=t}else{if("number"!=typeof e)throw new Error("Non expected value");f=e}}}),t.columnPadding&&(this.columnPadding=t.columnPadding);var g;Object.defineProperty(this,"linePadding",{get:function(){return g},set:function(e){if("string"==typeof e){var t=parseInt(e);if(!t)throw new Error("Non expected value");g=t}else{if("number"!=typeof e)throw new Error("Non expected value");g=e}}}),t.linePadding&&(this.linePadding=t.linePadding||0);var p=0,v=[];Object.defineProperty(this,"viewModel",{get:function(){return v},set:function(e){if(!(e instanceof Array))throw new Error("Non expected value");v=e,a.syncViewModel("refresh")}});var w;this.syncViewModel=function(e){e=e||"padding","refresh"===e||u?(refresh=!1,p=0,n(),o()):"padding"===e&&o()},this.addEventListener=function(){e.addEventListener.apply(e,arguments)},this.removeEventListener=function(){e.removeEventListener.apply(e,arguments)},this.remove=function(){e.parentNode&&e.parentNode.removeChild(e)},this.element=e,this.root=d,n()}var r=0;t.waterfall=n}(window,window.ctrl||(window.ctrl={}));