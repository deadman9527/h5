!function(a){var b={init:function(){this.len=this.render(),this.hideGoods(),this.getGoods();var a="物流详情";new ctrl.topBar({isIndex:!1,title:a})},addEvents:function(){var b=this,c=!0,d=!0;a(".hideLogistics").on("click",function(){0==d?(b.hideLogistics(a(this)),d=!0):(b.showLogistics(a(this)),d=!1)}),a("#hide-goods").on("click",function(){0==c?(b.hideGoods(),c=!0):(b.showGoods(),c=!1)})},getOrderSn:function(){httpUrl=new lib.httpurl(location.href);var a=httpUrl.params,b=a.order_sn?a.order_sn:"";return b},getGoods:function(){if(!lib.login.isLogin())return void lib.login.goLogin();var b=this;b.isAjax||(b.isAjax=!0,lib.api.get({needLogin:!0,api:{c:"order",a:"odetails"},data:{order_sn:b.getOrderSn()},success:function(c){console.log(c),c.order&&c.order.product?(b.renderItems(c.order),b.length=c.order.product.length,b.length>1?(b.hideGoods(),a("#hide-goods").css("display","block")):a("#hide-goods").hide(),b.addEvents()):b.renderError("empty")},error:function(a){a&&a.desc&&console.log(a.desc)},complete:function(){b.isAjax=!1}}))},render:function(){var b=this;lib.api.get({api:{c:"Logistics",a:"fast"},data:{order_sn:b.getOrderSn()},success:function(c){console.log(c),c&&("00000"==c.code?b.renderLogistics(c):a(".container").append("10002"==c.code?'<div class="logistics module"><p class="text-center o_tips">该订单还没有快递单号</p></div>':'<div class="logistics module"><p class="text-center o_tips">暂无物流信息</p></div>'),b.addEvents())},error:function(b){b&&b.desc&&(console.log(b.desc),a(".logistics").css("border-top","none"),a(".container").append('<div class="logistics module"><p class="text-center o_tips">该订单还没有快递单号</p></div>'))},complete:function(){}})},hideGoods:function(){var b=this;console.log("hide goods "+b.length),a(".goods ul li").first().show().siblings().hide(),a(".goods ul li").first().css("padding-bottom",0),a("#hide-goods").text("显示全部"+b.length+"条商品信息").css("color","#333")},showGoods:function(){console.log("show goods"),a(".goods ul li").show(),a(".goods ul li").first().css("padding-bottom","8px"),a("#hide-goods").text("收起").css("color","#999")},hideLogistics:function(a){console.log(a),a.siblings(".logistics_list").find("li.hide").hide(),a.text("查看全部物流信息").css("color","#333"),console.log("hide logistics over")},showLogistics:function(a){console.log("show logistics"),a.siblings(".logistics_list").find(".hide").show(),a.text("收起").css("color","#999"),console.log("show logistics over")},renderItems:function(b){var c=a(".goods-container"),d=a("#tpl-goods").html();c.append(_.template(d)({order:b}))},renderLogistics:function(b){console.log(orders);var c=a(".container"),d=a("#tpl-logistics").html();c.append(_.template(d)({orders:b.orders||"",code:b.code,desc:b.desc}))}};a(function(){b.init()})}(Zepto);