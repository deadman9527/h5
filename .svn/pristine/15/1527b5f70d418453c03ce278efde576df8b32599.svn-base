!function(e,t){function a(e,t){if(s={},s[e])return void t(s[e]);var a=[];if(1==e){for(var n=0;n<parseInt(endDates[0])-parseInt(startDates[0])+1;n++){var r=new Object;r.name=n+parseInt(startDates[0])+"年",r.id=n+2,a.push(r)}t(a),s[e]=a}if(e>=2&&19>=e){if(endDates[0]==startDates[0]){l=!0;for(var n=parseInt(startDates[1])-1;n<parseInt(endDates[1]);n++){var r=new Object;r.name=n+1+"月",r.id=n+21,a.push(r)}}else if(2==e){l=!1;for(var n=parseInt(startDates[1])-1;12>n;n++){var r=new Object;r.name=n+1+"月",r.id=n+21,a.push(r)}}else if(e==2+parseInt(endDates[0])-parseInt(startDates[0])){console.log("lastYear"),l=!0;for(var n=0;n<parseInt(endDates[1]);n++){var r=new Object;r.name=n+1+"月",r.id=n+21,a.push(r)}}else{l=!1;for(var n=0;12>n;n++){var r=new Object;r.name=n+1+"月",r.id=n+21,a.push(r)}}t(a),s[e]=a}if(e>=21&&32>=e){var i=30;if(22==e?i=28:(21==e||23==e||25==e||27==e||28==e||30==e||32==e)&&(i=31),endDates[0]==startDates[0])if(21==e)for(var n=parseInt(startDates[2])-1;i>n;n++){var r=new Object;r.name=n+1+"日",r.id=n+41,a.push(r)}else if(e==21+parseInt(endDates[1])-parseInt(startDates[1]))for(var n=0;n<parseInt(endDates[2]);n++){var r=new Object;r.name=n+1+"日",r.id=n+41,a.push(r)}else for(var n=0;i>n;n++){var r=new Object;r.name=n+1+"日",r.id=n+41,a.push(r)}else if(l&&e==21+parseInt(endDates[1])-parseInt(startDates[1]))for(var n=0;n<parseInt(endDates[2]);n++){var r=new Object;r.name=n+1+"日",r.id=n+41,a.push(r)}else if(21!=e||l)for(var n=0;i>n;n++){var r=new Object;r.name=n+1+"日",r.id=n+41,a.push(r)}else for(var n=parseInt(startDates[2])-1;i>n;n++){var r=new Object;r.name=n+1+"日",r.id=n+41,a.push(r)}t(a),s[e]=a}}function n(e){var t={},n={},r=e.id||1,i=e.deep||3,s=e.onReady,l={3:"year",2:"month",1:"day"};o=e.startDate||o,d=e.endDate||d,startDates=o.split("-"),endDates=d.split("-"),a(r,function(e){var r=l[i];n[r]=[],e.forEach(function(e,a){var i={key:e.name,value:e.id,selected:0===a};n[r].push(i),0===a&&(t[r]=i)}),i--,1>i?s&&s(n):a(t[r].value,arguments.callee)})}function r(e,t){t=t||{};var a=ctrl.selectmenu;i=new a({confirmText:t.confirmText||"确定",title:t.title||"",cancelText:t.opts||"取消",trigger:t.trigger}),i.viewModel=e,i.addEventListener("confirm",function(){t.onConfirm(this.selectedValue)}),i.addEventListener("select",function(e){var t=this.selectedValue["val-"+e],a=this;"year"==e?n({id:t,deep:2,onReady:function(e){a.linkage("month",e.month),a.linkage("day",e.day)}}):"month"==e&&n({id:t,deep:1,onReady:function(e){a.linkage("day",e.day)}})}),t.appendDom?t.appendDom.appendChild(i.root):document.body.appendChild(i.root)}var i,s={},o="2010-1-1",d="2016-1-1",l=!1;t.selectAddress={init:function(e){console.log(e),n({onReady:function(t){r(t,e)},startDate:e.startDate,endDate:e.endDate})}}}(Zepto,window.app||(window.app={})),function(e,t){function a(e,t){if(s={},s[e])return void t(s[e]);var a=[];if(1==e){for(var n=0;n<parseInt(endDates[0])-parseInt(startDates[0])+1;n++){var r=new Object;r.name=n+parseInt(startDates[0])+"年",r.id=n+2,a.push(r)}t(a),s[e]=a}if(e>=2&&19>=e){if(endDates[0]==startDates[0]){l=!0;for(var n=parseInt(startDates[1])-1;n<parseInt(endDates[1]);n++){var r=new Object;r.name=n+1+"月",r.id=n+21,a.push(r)}}else if(2==e){l=!1;for(var n=parseInt(startDates[1])-1;12>n;n++){var r=new Object;r.name=n+1+"月",r.id=n+21,a.push(r)}}else if(e==2+parseInt(endDates[0])-parseInt(startDates[0])){console.log("lastYear"),l=!0;for(var n=0;n<parseInt(endDates[1]);n++){var r=new Object;r.name=n+1+"月",r.id=n+21,a.push(r)}}else{l=!1;for(var n=0;12>n;n++){var r=new Object;r.name=n+1+"月",r.id=n+21,a.push(r)}}t(a),s[e]=a}if(e>=21&&32>=e){var i=30;if(22==e?i=28:(21==e||23==e||25==e||27==e||28==e||30==e||32==e)&&(i=31),endDates[0]==startDates[0])if(21==e)for(var n=parseInt(startDates[2])-1;i>n;n++){var r=new Object;r.name=n+1+"日",r.id=n+41,a.push(r)}else if(e==21+parseInt(endDates[1])-parseInt(startDates[1]))for(var n=0;n<parseInt(endDates[2]);n++){var r=new Object;r.name=n+1+"日",r.id=n+41,a.push(r)}else for(var n=0;i>n;n++){var r=new Object;r.name=n+1+"日",r.id=n+41,a.push(r)}else if(l&&e==21+parseInt(endDates[1])-parseInt(startDates[1]))for(var n=0;n<parseInt(endDates[2]);n++){var r=new Object;r.name=n+1+"日",r.id=n+41,a.push(r)}else if(21!=e||l)for(var n=0;i>n;n++){var r=new Object;r.name=n+1+"日",r.id=n+41,a.push(r)}else for(var n=parseInt(startDates[2])-1;i>n;n++){var r=new Object;r.name=n+1+"日",r.id=n+41,a.push(r)}t(a),s[e]=a}}function n(e){var t={},n={},r=e.id||1,i=e.deep||3,s=e.onReady,l={3:"year",2:"month",1:"day"};o=e.startDate||o,d=e.endDate||d,startDates=o.split("-"),endDates=d.split("-"),a(r,function(e){var r=l[i];n[r]=[],e.forEach(function(e,a){var i={key:e.name,value:e.id,selected:0===a};n[r].push(i),0===a&&(t[r]=i)}),i--,1>i?s&&s(n):a(t[r].value,arguments.callee)})}function r(e,t){t=t||{};var a=ctrl.selectmenu;i=new a({confirmText:t.confirmText||"确定",title:t.title||"",cancelText:t.opts||"取消",trigger:t.trigger}),i.viewModel=e,i.addEventListener("confirm",function(){t.onConfirm(this.selectedValue)}),i.addEventListener("select",function(e){var t=this.selectedValue["val-"+e],a=this;"year"==e?n({id:t,deep:2,onReady:function(e){a.linkage("month",e.month),a.linkage("day",e.day)}}):"month"==e&&n({id:t,deep:1,onReady:function(e){a.linkage("day",e.day)}})}),t.appendDom?t.appendDom.appendChild(i.root):document.body.appendChild(i.root)}var i,s={},o="2010-1-1",d="2016-1-1",l=!1;t.selectAddress={init:function(e){console.log(e),n({onReady:function(t){r(t,e)},startDate:e.startDate,endDate:e.endDate})}}}(Zepto,window.app2||(window.app2={})),function(e,t){function a(e,t){var e=e||"2015-03-21 00:00:00",t=t,a=e.replace(/-/g,"/"),n=new Date(a),r=n.getTime().toString(),i=e.substring(0,10).split("-");e=i[1]+"-"+i[2]+"-"+i[0]+" "+e.substring(10,19);var s=(t-r)/3600/1e3;return 0>s?!1:s>0?!0:0==s?!1:!1}var n=new Date,r=(n.getDate(),n.getMonth()+1,n.getFullYear(),new Date((new Date).getTime()+2592e7)),i=(r.getDate(),r.getMonth()+1,r.getFullYear(),window.navigator.userAgent.toLowerCase());SEMURL=i.match(/MobileVecn/i)?!1:!0,t.formatImgSrc=function(e){var t=e.match(/^http:\/\/img\.ve\.cnttp(.+)_3\.jpg/);return t?"http"+t[1]+".jpg":e},t.formatTitleLink=function(e,t,a){var n=new lib.httpurl(e);n.params.title=t?t:"";var r=n.toString().replace("http://h5.quxiu.me/",""),i="http://"+location.host,s=a?a:"",o=new lib.httpurl(i+"/"+s+"brandcate-"+n.params.brandId+".html");o.params.brandId=n.params.brandId,o.params.title=t?t:"";var d=o.toString(),l=SEMURL?d:r;return l};var s,o=document.documentElement,d={init:function(t){if(register_r?lib.storage.set("register_r",register_r):lib.storage.set("register_r",null),lib.storage.get("register_real"))this.renderFlash();else{s=e(document).width(),e(".realPropagation").show(),lib.storage.set("register_real",!0);var a=e(".realPropagation")[0];a.addEventListener("click",function(){e(".realPropagation").hide()})}var n=new lib.httpurl(location.href),r=n.params.pid?n.params.pid:"";lib.storage.set("pid",r),new lib.goTop,this.topbar=new ctrl.topBar({isIndex:!0}),e(".topbar").css("position","relative"),e("body").css("padding-top","0px"),e(".close-down").click(function(){e(".bottomdown").remove()}),e("#downapp").on("click",function(){var e="http://h5.quxiu.me/index.html",t=!0,a=!0;lib.callapp.gotoPage(e,{point:a,params:t})}),console.log(ctrl.topBar.getInfo().height),ctrl.topBar&&ctrl.topBar.getInfo&&(e("#target-fix")[0].style.top=-ctrl.topBar.getInfo().height||"0px"),this.opts=t,s=o.getBoundingClientRect().width,this.page=1,this.guideId="",this.categoryId="",this.cd=[],lib.lazyload.init();var i=this;this.infiniteScroll=lib.infiniteScroll.init({bufferPx:200,time:100,onNear:function(){console.log("onNear"),i.loadRecommend()},end:function(){return i.isEnd},onEnd:function(){i.hideTip("加载已完成!")},onScroll:function(){i.showTip("努力加载中...")}}),i.renderBottomBar(),this.render(0)},renderFlash:function(){var t=new Date;a(null,t.getTime()),e.ajax({url:"http://act.quxiu.me/data/indexflash.json",data:{},dataType:"json",success:function(n){var n=n.data;lib.storage.get("indexFlash")||lib.storage.set("indexFlash",[]);var r=lib.storage.get("indexFlash"),i=!1;if(n.length>0){for(var s=0;s<n.length;s++){if(r.length>0){for(var o in r)if(n[s].id==r[o]){i=!0;break}}else{if(a(n[s].startDate,t.getTime())&&!a(n[s].endDate,t.getTime())){e("body").append('<div class="flashbg"></div>'),r.push(n[s].id),lib.storage.set("indexFlash",r),n[s].color?e(".flashbg").css("background","#"+n[s].color):e(".flashbg").css("background","#ff3862"),e(".flashbg").html('<span class="close" id="flash-close" ></span><a href="'+n[s].targetUrl+'"><div class="flash lazy" id="flash" dataimg="'+n[s].img+'" > </div></a>'),i=!1;break}i=!0}if(i)break}i?(e(".flashbg").hide(),e("body").css("overflow","auto")):(e(".flashbg").show(),e("body").css("overflow","hidden"),e("#flash-close").on("click",function(){e(".flashbg").hide(),e("body").css("overflow","auto")}),lib.lazyload.trigger(),setTimeout(function(){e(".flashbg").remove()},5e3))}},error:function(){},complete:function(){}})},renderBottomBar:function(){this.bottombar=new ctrl.bottomBar({hoverIndex:0,showBottom:!0,showApp:!1,showCircle:!1}),e("#callApp").on("click",function(){var e="http://h5.quxiu.me/index.html",t=!0,a=!0;lib.callapp.gotoPage(e,{point:a,params:t})})},renderAge:function(){var t=this;e(".guide-status span").on("click",function(){e("#guide").hide(),lib.storage.set("guideOver",1),t.renderBottomBar(),t.render(0),t.topbar.setIndexName(imgdom+"我的定制")}),e(".guide-main a").on("click",function(){t.guideType=parseInt(e(this).attr("guideType"))}),this.renderGuide()},selectTime:function(e,t,a){lib.login.isLogin()?lib.api.get({needLogin:!0,api:{c:"user",a:"loadbaby"},data:{sex:t,birthday:e},success:function(e){lib.storage.set("guideFilter",parseInt(e.data.filter)),location.reload()},error:function(){data&&data.desc&&(console.log(data.desc),lib.notification.alert(data.desc,function(){this.hide()}).show())},complete:function(){}}):(lib.storage.set("guideBirthday",e),lib.storage.set("guideBabytype",t),this.renderGuideOld(a))},renderGuideOld:function(e){var t=this;t.filter=3==t.guideType?2:2==t.guideType?e>6?5:e>=3&&6>=e?3:1:e>6?4:e>=3&&6>=e?3:1,lib.storage.set("guideFilter",t.filter),location.reload()},addEvents:function(){var t=this;e(".top-back").on("click",function(){location.href="agefilter.html"}),lib.login.isLogin()?e(".agefilter a").on("click",function(){e(".agefilter").hide(),t.topbar.setIndexName(e(this).attr("name")),t.render(e(this).attr("filter"))}):e(".agefilter a").on("click",function(){e(".agefilter").hide(),t.topbar.setIndexName(e(this).attr("name")),t.render(e(this).attr("filter"))})},render:function(e){this.renderMain(e),this.renderRush()},renderMain:function(e){var t=this;t.isAjax||(t.isAjax=!0,lib.api.get({api:{c:"main",a:""},data:{filter:e},success:function(e){if(!e.data)return void t.renderError("network");var e=e.data,a=e.banner||[];a=t.opts.banner?a.concat(t.opts.banner):a,e.banner&&t.renderSlide(a),e.icon&&t.renderNav(e.icon),e.adv&&t.renderCard(e.adv),e.hot&&t.renderRush(e.hot),t.categoryId=e.cateid,e.cateid&&t.loadRecommend(!1,e.cate),lib.lazyload.trigger()},error:function(){t.renderError("network")},complete:function(){t.isAjax=!1}}))},renderTabheader:function(t){var a=this;a.guideId=t,this.loadBrands();var n=new ctrl.tabheader;document.getElementsByClassName("brand-menus")[0].appendChild(n.root),n.viewModel={content:t,bottom:!1,top:!0,hasMore:!0,colNumber:3},n.addEventListener("select",function(e){for(var t=0;t<a.cd.length;t++)a.cd[t].stop();a.guideId=e.selected.guideId,a.loadRecommend(!0)},!0),e(".brand-menus").css("top","0px")},renderSlide:function(t){var a=e("#slides"),n=e("#tpl-slides").html();a.html(_.template(n)({itemList:t,w:s})),this.slider=new lib.Slider(".slider-box",{loop:!0,play:!0,trigger:".slider-status"})},renderNav:function(t){var a=e("#cate-navs"),n=e("#tpl-cate-navs").html();a.html(_.template(n)({itemList:t}))},renderRush:function(t){var a=e("#rush"),n=e("#tpl-rush").html();a.html(_.template(n)({itemList:t}));new Swiper("#rush-items",{slidesPerView:"auto",paginationClickable:!0,spaceBetween:30})},renderCard:function(t){var a=e("#cards"),n=e("#tpl-cards").html();a.html(_.template(n)({itemList:t}))},loadRecommend:function(t,a){var n=this;if(t)n.page=1;else if(n.isAjaxRecommends)return;n.isAjaxRecommends=!0,lib.api.get({api:{c:"main",a:"get_nav_goods",nav_id:n.categoryId||"",is_index:1},data:{p:this.page},success:function(r){if(r.data){var r=r.data;n.page>=r.total?n.infiniteScroll.triggerEnd():(n.page++,!n.infiniteScroll.started&&n.infiniteScroll.start()),r.list&&n.renderRecommend(r.list,a,t),t&&e("#target-fix")[0].scrollIntoView()}},error:function(){n.renderError("network")},complete:function(){n.isAjaxRecommends=!1}})},renderRecommend:function(t,a,n){var r=this,i=e(".recommend-item").length-1;r.existTimeNumber=n?0:i,e(".info-tip").hide();var s=e("#recommendList"),o=e("#tpl-recommend").html();s[n?"html":"append"](_.template(o)({itemList:t,categoryList:a,existNumber:i}));lib.lazyload.trigger()},renderTime:function(t,a,n){var r=this,i=3600*parseInt(t[0])*24+3600*parseInt(t[1])+parseInt(60*t[2])+parseInt(10*t[3])/10;i>0?(r.cd[a+r.existTimeNumber]=lib.countdown({endDate:"+"+i.toString(),stringFormatter:t[0]>0?"d天hh小时mm分ss秒":t[1]>0?"hh小时mm分ss秒":t[2]>0?"mm分ss秒":"ss秒",interval:1e3,onUpdate:function(t){e(".b_"+n).html("还剩："+t.stringValue)},onEnd:function(){console.log("cd["+a+"] ended")}}).start(),e(".time-end").show()):e(".time-end").remove()},renderError:function(e){switch(e){case"param":this.showTip("参数请求错误");break;case"network":this.showTip("服务器开小差啦");break;case"empty":this.showTip("当前条件，数据为空")}},showTip:function(t){var a=e("#info-tip");a.html(t).show()},hideTip:function(t){var a=e("#info-tip");t?(a.html("加载已完毕").show(),setTimeout(function(){a.hide()},5e3)):a.hide()}};e(function(){d.init({banner:[]})})}(Zepto,window.Global||(window.Global={}));