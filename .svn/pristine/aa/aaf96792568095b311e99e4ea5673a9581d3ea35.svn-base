!function(t){"use strict";function e(t,e){for(var n=t;n;){if(n.contains(e)||n==e)return n;n=n.parentNode}return null}function n(t,e,n){var a=r.createEvent("HTMLEvents");if(a.initEvent(e,!0,!0),"object"==typeof n)for(var i in n)a[i]=n[i];t.dispatchEvent(a)}function a(t,e,n,a,i,c,o,s){var r=Math.atan2(s-c,o-i)-Math.atan2(a-e,n-t),l=Math.sqrt((Math.pow(s-c,2)+Math.pow(o-i,2))/(Math.pow(a-e,2)+Math.pow(n-t,2))),u=[i-l*t*Math.cos(r)+l*e*Math.sin(r),c-l*e*Math.cos(r)-l*t*Math.sin(r)];return{rotate:r,scale:l,translate:u,matrix:[[l*Math.cos(r),-l*Math.sin(r),u[0]],[l*Math.sin(r),l*Math.cos(r),u[1]],[0,0,1]]}}function i(t){0===Object.keys(h).length&&(l.addEventListener("touchmove",c,!1),l.addEventListener("touchend",o,!1),l.addEventListener("touchcancel",s,!1));for(var a=0;a<t.changedTouches.length;a++){var i=t.changedTouches[a],r={};for(var v in i)r[v]=i[v];var d={startTouch:r,startTime:Date.now(),status:"tapping",element:t.srcElement,pressingHandler:setTimeout(function(e){return function(){"tapping"===d.status&&(d.status="pressing",n(e,"press",{touchEvent:t})),clearTimeout(d.pressingHandler),d.pressingHandler=null}}(t.srcElement),500)};h[i.identifier]=d}if(2==Object.keys(h).length){var p=[];for(var v in h)p.push(h[v].element);n(e(p[0],p[1]),"dualtouchstart",{touches:u.call(t.touches),touchEvent:t})}}function c(t){for(var i=0;i<t.changedTouches.length;i++){var c=t.changedTouches[i],o=h[c.identifier];if(!o)return;o.lastTouch||(o.lastTouch=o.startTouch),o.lastTime||(o.lastTime=o.startTime),o.velocityX||(o.velocityX=0),o.velocityY||(o.velocityY=0),o.duration||(o.duration=0);var s=Date.now()-o.lastTime,r=(c.clientX-o.lastTouch.clientX)/s,l=(c.clientY-o.lastTouch.clientY)/s,u=70;s>u&&(s=u),o.duration+s>u&&(o.duration=u-s),o.velocityX=(o.velocityX*o.duration+r*s)/(o.duration+s),o.velocityY=(o.velocityY*o.duration+l*s)/(o.duration+s),o.duration+=s,o.lastTouch={};for(var v in c)o.lastTouch[v]=c[v];o.lastTime=Date.now();var d=c.clientX-o.startTouch.clientX,p=c.clientY-o.startTouch.clientY,m=Math.sqrt(Math.pow(d,2)+Math.pow(p,2));("tapping"===o.status||"pressing"===o.status)&&m>10&&(o.status="panning",o.isVertical=!(Math.abs(d)>Math.abs(p)),n(o.element,"panstart",{touch:c,touchEvent:t,isVertical:o.isVertical}),n(o.element,(o.isVertical?"vertical":"horizontal")+"panstart",{touch:c,touchEvent:t})),"panning"===o.status&&(o.panTime=Date.now(),n(o.element,"pan",{displacementX:d,displacementY:p,touch:c,touchEvent:t,isVertical:o.isVertical}),o.isVertical?n(o.element,"verticalpan",{displacementY:p,touch:c,touchEvent:t}):n(o.element,"horizontalpan",{displacementX:d,touch:c,touchEvent:t}))}if(2==Object.keys(h).length){for(var f,g=[],T=[],E=[],i=0;i<t.touches.length;i++){var c=t.touches[i],o=h[c.identifier];g.push([o.startTouch.clientX,o.startTouch.clientY]),T.push([c.clientX,c.clientY])}for(var v in h)E.push(h[v].element);f=a(g[0][0],g[0][1],g[1][0],g[1][1],T[0][0],T[0][1],T[1][0],T[1][1]),n(e(E[0],E[1]),"dualtouch",{transform:f,touches:t.touches,touchEvent:t})}}function o(t){if(2==Object.keys(h).length){var a=[];for(var i in h)a.push(h[i].element);n(e(a[0],a[1]),"dualtouchend",{touches:u.call(t.touches),touchEvent:t})}for(var r=0;r<t.changedTouches.length;r++){var d=t.changedTouches[r],p=d.identifier,m=h[p];if(m){if(m.pressingHandler&&(clearTimeout(m.pressingHandler),m.pressingHandler=null),"tapping"===m.status&&(m.timestamp=Date.now(),n(m.element,"tap",{touch:d,touchEvent:t}),v&&m.timestamp-v.timestamp<300&&n(m.element,"doubletap",{touch:d,touchEvent:t}),v=m),"panning"===m.status){var f=Date.now(),g=f-m.startTime,T=((d.clientX-m.startTouch.clientX)/g,(d.clientY-m.startTouch.clientY)/g,d.clientX-m.startTouch.clientX),E=d.clientY-m.startTouch.clientY,y=Math.sqrt(m.velocityY*m.velocityY+m.velocityX*m.velocityX),M=y>.5&&f-m.lastTime<100,X={duration:g,isflick:M,velocityX:m.velocityX,velocityY:m.velocityY,displacementX:T,displacementY:E,touch:d,touchEvent:t,isVertical:m.isVertical};n(m.element,"panend",X),M&&(n(m.element,"flick",X),m.isVertical?n(m.element,"verticalflick",X):n(m.element,"horizontalflick",X))}"pressing"===m.status&&n(m.element,"pressend",{touch:d,touchEvent:t}),delete h[p]}}0===Object.keys(h).length&&(l.removeEventListener("touchmove",c,!1),l.removeEventListener("touchend",o,!1),l.removeEventListener("touchcancel",s,!1))}function s(t){if(2==Object.keys(h).length){var a=[];for(var i in h)a.push(h[i].element);n(e(a[0],a[1]),"dualtouchend",{touches:u.call(t.touches),touchEvent:t})}for(var r=0;r<t.changedTouches.length;r++){var v=t.changedTouches[r],d=v.identifier,p=h[d];p&&(p.pressingHandler&&(clearTimeout(p.pressingHandler),p.pressingHandler=null),"panning"===p.status&&n(p.element,"panend",{touch:v,touchEvent:t}),"pressing"===p.status&&n(p.element,"pressend",{touch:v,touchEvent:t}),delete h[d])}0===Object.keys(h).length&&(l.removeEventListener("touchmove",c,!1),l.removeEventListener("touchend",o,!1),l.removeEventListener("touchcancel",s,!1))}var r=t.document,l=r.documentElement,u=Array.prototype.slice,h={},v=null;l.addEventListener("touchstart",i,!1)}(window,window.lib||(window.lib={}));