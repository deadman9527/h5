!function(i){Global.formatImgSrc=function(i){if(!i)return"http://h5.quxiu.me/assets/img/cart_img_black_640x253.png";var t=i.match(/^http:\/\/img\.ve\.cnttp(.+)_3\.jpg/);return t?"http"+t[1]+".jpg":i};var t={init:function(){var i=new lib.httpurl(location.href),t=i.params,n=t.title?decodeURIComponent(t.title):"申请退货";document.title=n,this.orderSn=t.orderSn||0,new ctrl.topBar({isIndex:!1,title:n}),this.bottombar=new ctrl.bottomBar({showBottom:!0}),lib.lazyload.init(),this.render(!0),new lib.goTop({position:{bottom:60}})},addEventsLink:function(){var t=this;i(".detail-link").on("click",function(){var t=i(this).attr("data-id"),n="order-detail.html?orderSn="+t;window.location.href=n}),i(".show").on("click",function(){i(this).closest(".order-container").find(".hidden").removeClass("hidden"),i(this).addClass("hidden")}),i(".hide").on("click",function(){i(this).closest(".order-container").find("ul li").addClass("hidden").eq(0).removeClass("hidden"),i(".show").removeClass("hidden"),i(this).addClass("hidden")}),i(".return").on("click",function(){lib.api.get({api:{c:"returngoods",a:"index"},needLogin:!0,data:{order_sn:t.orderSn,return_desc:i(".return-input").val()},success:function(i){console.log(i),t.hideTip(),t.renderItems(i.order),t.addEventsLink()},error:function(i){var t=lib.notification.alert(i.desc,function(){this.hide()});t.show()},complete:function(){t.isAjax=!1}})})},render:function(){if(!lib.login.isLogin())return void lib.login.goLogin();var i=this;i.isAjax||(i.isAjax=!0,lib.api.get({api:{c:"order",a:"odetails"},needLogin:!0,data:{order_sn:i.orderSn},success:function(t){console.log(t),i.hideTip(),i.renderItems(t.order),i.addEventsLink()},error:function(t){"10007"==t.code&&(i.infiniteScroll.remove(),1==i.page&&i.showTip("该状态还没有订单~"))},complete:function(){i.isAjax=!1}}))},renderItems:function(t){i(".info-tip").hide(),console.log(this.status);var n=i("#orders"),e=i("#tpl-item").html();n.append(_.template(e)({item:t})),lib.lazyload.trigger()},renderError:function(i){switch(i){case"param":this.showTip("缺少必要参数");break;case"network":this.showTip("服务器开小差啦");break;case"empty":this.showTip("当前条件，列表为空")}},showTip:function(t){var n=i(".info-tip");n.html(t).show()},hideTip:function(){var t=i(".info-tip");t.html("").hide()}};i(function(){t.init()})}(Zepto,window.Global||(window.Global={}));