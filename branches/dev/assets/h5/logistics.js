!function(o){var s={init:function(){this.len=this.render(),this.hideGoods(),this.getGoods();var o="物流详情";new ctrl.topBar({isIndex:!1,title:o})},addEvents:function(){var s=this,i=!0,e=!0;o(".hideLogistics").on("click",function(){0==e?(s.hideLogistics(o(this)),e=!0):(s.showLogistics(o(this)),e=!1)}),o("#hide-goods").on("click",function(){0==i?(s.hideGoods(),i=!0):(s.showGoods(),i=!1)})},getOrderSn:function(){httpUrl=new lib.httpurl(location.href);var o=httpUrl.params,s=o.order_sn?o.order_sn:"";return s},getGoods:function(){if(!lib.login.isLogin())return void lib.login.goLogin();var s=this;s.isAjax||(s.isAjax=!0,lib.api.get({needLogin:!0,api:{c:"order",a:"odetails"},data:{order_sn:s.getOrderSn()},success:function(i){console.log(i),i.order&&i.order.product?(s.renderItems(i.order),s.length=i.order.product.length,s.length>1?(s.hideGoods(),o("#hide-goods").css("display","block")):o("#hide-goods").hide(),s.addEvents()):s.renderError("empty")},error:function(o){o&&o.desc&&console.log(o.desc)},complete:function(){s.isAjax=!1}}))},render:function(){var s=this;lib.api.get({api:{c:"Logistics",a:"fast"},data:{order_sn:s.getOrderSn()},success:function(i){console.log(i),i&&("00000"==i.code?s.renderLogistics(i):o(".container").append("10002"==i.code?'<div class="logistics module"><p class="text-center o_tips">该订单还没有快递单号</p></div>':'<div class="logistics module"><p class="text-center o_tips">暂无物流信息</p></div>'),s.addEvents())},error:function(s){s&&s.desc&&(console.log(s.desc),o(".logistics").css("border-top","none"),o(".container").append('<div class="logistics module"><p class="text-center o_tips">该订单还没有快递单号</p></div>'))},complete:function(){}})},hideGoods:function(){var s=this;console.log("hide goods "+s.length),o(".goods ul li").first().show().siblings().hide(),o(".goods ul li").first().css("padding-bottom",0),o("#hide-goods").text("显示全部"+s.length+"条商品信息").css("color","#333")},showGoods:function(){console.log("show goods"),o(".goods ul li").show(),o(".goods ul li").first().css("padding-bottom","8px"),o("#hide-goods").text("收起").css("color","#999")},hideLogistics:function(o){console.log(o),o.siblings(".logistics_list").find("li.hide").hide(),o.text("查看全部物流信息").css("color","#333"),console.log("hide logistics over")},showLogistics:function(o){console.log("show logistics"),o.siblings(".logistics_list").find(".hide").show(),o.text("收起").css("color","#999"),console.log("show logistics over")},renderItems:function(s){var i=o(".goods-container"),e=o("#tpl-goods").html();i.append(_.template(e)({order:s}))},renderLogistics:function(s){console.log(orders);var i=o(".container"),e=o("#tpl-logistics").html();i.append(_.template(e)({orders:s.orders||"",code:s.code,desc:s.desc}))}};o(function(){s.init()})}(Zepto);