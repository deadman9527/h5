!function(e){var t={init:function(){var t=new lib.httpurl(location.href),s=t.params,i=s.title?decodeURIComponent(s.title):"选择地址";document.title=i,new ctrl.topBar({isIndex:!1,title:i}),this.is_select=s.is_select||0,this.proType=s.proType||0,this.is_select&&e(".add-address").attr("href","address-add.html?toConfirm=1&proType="+this.proType),lib.lazyload.init(),this.render(),new lib.goTop},addEvents:function(){var t=this;e(".save-btn").on("click",function(){lib.storage.set("addressSelectedId",e(".active").closest(".address-container").attr("data-id")),window.location.href="order-confirm.html"+(t.proType?"?proType=1":"")})},addEventsSelect:function(){var t=this;e(".address-container").on("click",function(){if(t.is_select)e(this).find(".active").length||(e(".active").remove(),e(this).append('<span class="active"></span>'),lib.storage.set("addressSelectedId",e(".active").closest(".address-container").attr("data-id")),setTimeout(function(){window.location.href="order-confirm.html"+(t.proType?"?proType=1":"")},500),e(".address-container").unbind("click"));else{var s=e(this).index();lib.storage.set("editAddressData",t.addressData[s]),window.location.href="address-add.html?title=编辑地址"}})},render:function(){var e=this;e.isAjax||(e.isAjax=!0,lib.api.get({needLogin:!0,api:{c:"user",a:"getaddress"},data:{},success:function(t){console.log(t),e.addressData=t.addresses,e.renderAddress(t),e.addEventsSelect(),e.addEvents()},error:function(e){if("00007"!=e.code){var t=lib.notification.alert(e.desc,function(){this.hide()},{useTap:!0});t.show()}},complete:function(){e.isAjax=!1}}))},checkNeedScroll:function(){return!this.is_have},renderAddress:function(t){var s=e("#addresses"),i=e("#tpl-address").html();s.append(_.template(i)({data:t,is_select:this.is_select}))},renderSaveBtn:function(){var t=e(".main"),s=e("#tpl-save-btn").html();t.append(_.template(s)({is_select:this.is_select}))},renderError:function(e){switch(e){case"param":this.showTip("缺少必要参数");break;case"network":this.showTip("服务器开小差啦");break;case"empty":this.showTip("当前条件，列表为空")}},showTip:function(t){var s=e(".info-tip");s.html(t).show()}};e(function(){t.init()})}(Zepto,window.Global||(window.Global={}));