!function(s,i){function t(s){if(s.products.suxing&&s.products.suxing[0].xxsx.length>1){if(this.evaDialog=new lib.Dialog({boxClass:"#sku-dialog",triggerClass:".sku-trigger",onShow:function(){setTimeout(function(){i(".sku-dialog-box").css("-webkit-transform","translateY(0%)")},100),i(".ve-gotop").hide(),i("body").css("overflow","hidden")},onHide:function(){i(".ve-gotop").show(),i("body").css("overflow","auto")}}),s.products.suxing)var t="1"==s.products.suxing[0].xxsx[0].is_phone_price?s.products.suxing[0].xxsx[0].phone_price:s.products.suxing[0].xxsx[0].current_price;else var t="1"==s.products.is_phone_price?s.products.phone_price:s.products.current_price;var u='<ul id="dia-sku-top">';u+="<li>",u+='<img src="'+s.products.images[0].url+'" width="50">',u+="</li>",u+='<li class="sku-title">',u+="<h1>"+s.products.name+"</h1>",u+="<h2>",u+='<span class="price-big">￥<span id="sku-bigpri">'+t+"</span></span>",u+='<span class="price-small line-through">￥'+s.products.origin_price+"</span>",u+="</h2>",u+="</li>",u+='<li class="float-right pro-cancle">',u+='<img class="sku-cancel" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjAyMEJBRURENzIwQzExRTRBREVGQjY5MjkzOEU1QzdEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjAyMEJBRURFNzIwQzExRTRBREVGQjY5MjkzOEU1QzdEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDIwQkFFREI3MjBDMTFFNEFERUZCNjkyOTM4RTVDN0QiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDIwQkFFREM3MjBDMTFFNEFERUZCNjkyOTM4RTVDN0QiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5pWN6tAAABBklEQVR42sTTzQ3CMAwF4PDENnSfTlMOwBIdoczT7kMsFSmEtPlxbFt6PbxcPqn2ZZ7nxTn38Nmc7dx8JvjP0+e9F5YYMrwItPqMhqgvhgwr9tIK9YOhAsGjNuoPE4M0UUMKkwJpoAizpDBHIEnUKeYMJIHKYnKgnqgiTAmoB6oYUwrioKowNaAWVDWmFlSDasK0gGLU0BPTCgpRS4RiYWiujFMOUePesTBcUIxyXAznl4kNFxTuTGqnVEHxAq89UOiEyV2fKCh32iwUOmPYKAhgWCgIYZpREMQ0oSCMqUZBAVOFghKmGAVFTBEKypgsCgaYUxSMMIcoGGKSKAJNhpgYdf8IMABOUYgZIYoSlgAAAABJRU5ErkJggg==">',u+="</li>",u+="</ul>",i(".pro-sku-top").html(u),i(".sku-cancel").on("click",function(){i(".sku-dialog-box").css("-webkit-transform","translateY(100%)"),setTimeout(function(){i("#sku-dialog").hide(),i("body").css("overflow","auto")},300)});var o="";if(s.products.suxing)for(var r=0;r<s.products.suxing[0].xxsx.length;r++){var n="1"==s.products.suxing[0].xxsx[r].is_phone_price?s.products.suxing[0].xxsx.phone_price:s.products.suxing[0].xxsx[r].current_price;o+='<span barcode="'+s.products.suxing[0].xxsx[r].id+'" current_price="'+n+'" is_stock="'+s.products.suxing[0].xxsx[r].is_stock+'" select="false">'+s.products.suxing[0].xxsx[r].name+"</span>"}var c='<div class="sku-size" id="dia-sku-size"><h1>尺寸：</h1>';c+=o+'</div><div class="sku-count">',c+='<span class="float-left">数量：</span><span class="float-right"><div id="J_Num1" class="num ctrl-number clearfix"><div class="minus J_Minus">-</div>            <input class="J_InputNum input-num" type="number" value="1">            <div class="add J_Add">+</div>    </div></span></div>',c+='<input id="sku-size" type="hidden" val="" value=""><input id="sku-color" type="hidden">',i(".pro-sku-body").html(c);var l=0==parseInt(s.products.user_min_bought)?1:s.products.user_min_bought,a=0==parseInt(s.products.user_max_bought)?999:s.products.user_max_bought;this.number=new ctrl.number({el:"#J_Num1",step:1,quantity:l,min:l,max:a}),s.products.suxing&&s.products.suxing[0].xxsx.length>=1&&(i(".sku-size span:eq(0)").attr("select","true"),i(".sku-size span:eq(0)").css("border",parseInt(i("html").attr("dataset").dpr)+"px solid #ff3862"),i(".sku-size span:eq(0)").css("color","#ff3862"),i("#sku-size").val(s.products.suxing[0].xxsx[0].id)),i(".sku-size span").click(function(){"false"==i(this).attr("select")?(i("#sku-size").val(i(this).attr("barcode")),i(".sku-size span").attr("select","false"),i(".sku-size span").css("border",parseInt(i("html").attr("dataset").dpr)+"px solid #333333"),i(".sku-size span").css("color","#333333"),i(this).attr("select","true"),i(this).css("border",parseInt(i("html").attr("dataset").dpr)+"px solid #ff3862"),i(this).css("color","#ff3862"),i("#sku-bigpri").html(i(this).attr("current_price"))):(i("#sku-size").val(""),i(".sku-size span").css("border",parseInt(i("html").attr("dataset").dpr)+"px solid #333333"),i(".sku-size span").css("color","#333333"),i(".sku-size span").attr("select","false"))}),i(".pro-sku-foot span").click(function(){e(s)})}else i(".sku-trigger").click(function(){e(s)})}function e(s){lib.login.isLogin()||lib.storage.set("accessToken","");var t,e;if(s.products.suxing&&s.products.suxing[0].xxsx.length>1)t=i("#sku-size").val(),e=i(this.number.$inputNum).attr("valueAsNumber");else if(s.products.suxing){t=s.products.suxing[0].xxsx[0].id;try{e="0"==s.products.suxing[0].xxsx[0].user_min_bought?1:s.products.suxing[0].xxsx[0].user_min_bought,e||(e="0"==s.products.user_min_bought?1:s.products.user_min_bought)}catch(u){e="0"==s.products.user_min_bought?1:s.products.user_min_bought}}else t="",e="0"==s.products.user_min_bought?1:s.products.user_min_bought;var o=this;if(o.data=s,!o.skusure_isAjax){o.goodsNumber=e?e:i(this.number.$inputNum).attr("valueAsNumber"),o.skusure_isAjax=!0;var r={attr:t,user_min_bought:null,free_ship:null,user_max_bought:null,img:null,imgurl:null,isSelect:!0,suxing:null,itemid:null,nofree_ship_info:null,sourceId:null,source:null,settle:null,promotions:null,product_name:null,productid:this.productId,price:0,origin_price:0,position:0,num:e,is_stock:0,gift:!1,decrease:!1};console.log("["+JSON.stringify(r)+"]"),lib.api.get({api:{c:"shoping",a:"addtocart"},data:{json:"["+JSON.stringify(r)+"]",accessToken:lib.storage.get("accessToken"),buy_now:1},success:function(s){console.log(s),lib.h5log.log(["setCustomVariable",4,"goodsNumber",o.goodsNumber,"page"]),null!=t&&e&&(lib.login.isLogin()?0==o.data.products.is_sea_label?setTimeout(function(){location.href="http://h5.quxiu.me/order-confirm.html"},50):setTimeout(function(){location.href="http://h5.quxiu.me/order-confirm.html?proType=1"},50):0==o.data.products.is_sea_label?setTimeout(function(){location.href="http://h5.quxiu.me/direct-order-confirm.html?cartId="+s.cart_id},50):setTimeout(function(){location.href="http://h5.quxiu.me/direct-order-confirm.html?proType=1&cartId="+s.cart_id},50))},error:function(s){if(s&&""!=s.desc)var i=s.desc;else i="服务器开小差啦";alert(i)},complete:function(){o.skusure_isAjax=!1}})}}this.productId=i("#sku").attr("pid"),this.brandId=null;lib.api.get({api:{c:"deal",a:"detail"},data:{productId:this.productId},success:function(s){console.log(s),t(s)},error:function(s){console.log(s)},complete:function(){}})}(this,Zepto);