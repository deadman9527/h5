!function(t,e){var i=t.Zepto||t.$,s=function(){var t="WebkitTransform"in document.documentElement.style?!0:!1;return t},n=function(){var t,e=!1,i=document.createElement("div"),t=["&#173;",'<style id="smodernizr">',"@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}","</style>"].join(""),s=document.documentElement.style;return i.id="modernizr",i.innerHTML+=t,document.body.appendChild(i),"WebkitPerspective"in s&&"webkitPerspective"in s&&(e=9===i.offsetLeft&&3===i.offsetHeight),i.parentNode.removeChild(i),e},r=n?"translate3d(":"translate(",a=n?",0)":")",o=function(t,e){return t?(e?e.container=t:e="string"==typeof t?{container:t}:t,i.extend(this,{container:".slider",wrap:null,panel:null,trigger:null,activeTriggerCls:"sel",hasTrigger:!1,steps:0,left:0,visible:1,margin:0,curIndex:0,duration:300,loop:!1,play:!1,interval:5e3,useTransform:n?!0:!1,lazy:".lazyimg",lazyIndex:1,callback:null,prev:null,next:null,activePnCls:"none"},e),void(this.findEl()&&this.init()&&this.increaseEvent())):null};i.extend(o.prototype,{reset:function(t){this.loop&&(this._oldLoop=!0),i.extend(this,t||{}),this.init()},findEl:function(){var t=this.container=i(this.container);return t.length?(this.wrap=this.wrap&&t.find(this.wrap)||t.children().first(),this.wrap.length?(this.panel=this.panel&&t.find(this.panel)||this.wrap.children().first(),this.panel.length?(this.panels=this.panel.children(),this.panels.length?(this.trigger=this.trigger&&t.find(this.trigger),this.prev=this.prev&&t.find(this.prev),this.next=this.next&&t.find(this.next),this):(this.container.hide(),null)):null):null):null},init:function(){var t=this.wrap,e=this.panel,i=this.panels,r=this.trigger,a=this.len=i.length,o=this.margin,h=0,l=this.visible,c=this.useTransform=s?this.useTransform:!1;this.steps=this.steps||t.width(),i.each(function(t,e){h+=e.offsetWidth}),o&&"number"==typeof o&&(h+=(a-1)*o,this.steps+=o),l>1&&(this.loop=!1);var d=this.left;d-=this.curIndex*this.steps,this.setCoord(e,d),c&&(n&&t.css({"-webkit-transform":"translateZ(0)"}),e.css({"-webkit-backface-visibility":"hidden"}));var p=this._pages=Math.ceil(a/l);if(this._minpage=0,this._maxpage=this._pages-1,this.loadImg(),this.updateArrow(),1>=p)return this.getImg(i[0]),r&&r.hide(),null;if(this._oldLoop){var u=e.children();u.eq(u.length-2).remove(),u.eq(u.length-1).remove()}if(this.loop){e.append(i[0].cloneNode(!0));var v=i[a-1].cloneNode(!0);e.append(v),this.getImg(v),v.style.cssText+="position:relative;left:"+-this.steps*(a+2)+"px;",h+=i[0].offsetWidth,h+=i[a-1].offsetWidth}if(e.css("width",h),r&&r.length){var f="",g=r.children();if(!g.length){for(var m=0;p>m;m++)f+="<span"+(m==this.curIndex?" class="+this.activeTriggerCls:"")+"></span>";r.html(f)}this.triggers=r.children(),this.triggerSel=this.triggers[this.curIndex]}else this.hasTrigger=!1;return this.slideTo(this.curIndex),this},increaseEvent:function(){var t=this,e=t.wrap[0],s=t.prev,n=t.next,r=t.triggers;e.addEventListener&&(e.addEventListener("touchstart",t,!1),e.addEventListener("touchmove",t,!1),e.addEventListener("touchend",t,!1),e.addEventListener("webkitTransitionEnd",t,!1),e.addEventListener("msTransitionEnd",t,!1),e.addEventListener("oTransitionEnd",t,!1),e.addEventListener("transitionend",t,!1)),t.play&&t.begin(),s&&s.length&&s.on("click",function(e){t.backward.call(t,e)}),n&&n.length&&n.on("click",function(e){t.forward.call(t,e)}),t.hasTrigger&&r&&r.each(function(e,s){i(s).on("click",function(){t.slideTo(e)})})},handleEvent:function(t){switch(t.type){case"touchstart":this.start(t);break;case"touchmove":this.move(t);break;case"touchend":case"touchcancel":this.end(t);break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"transitionend":this.transitionEnd(t)}},loadImg:function(t){t=t||0,t<this._minpage?t=this._maxpage:t>this._maxpage&&(t=this._minpage);var e=this.visible,i=this.lazyIndex-1,s=i+t;if(!(s>this._maxpage)){s+=1;var n=(t&&i+t||t)*e,r=s*e,a=this.panels;r=Math.min(a.length,r);for(var o=n;r>o;o++)this.getImg(a[o])}},getImg:function(t){if(t&&(t=i(t),!t.attr("l"))){var e=this,s=e.lazy,n="img"+s;s=s.replace(/^\.|#/g,""),t.find(n).each(function(t,e){var n=i(e);src=n.attr("dataimg"),src&&n.attr("src",src).removeAttr("dataimg").removeClass(s)}),t.attr("l","1")}},start:function(t){var e=t.touches[0];this._movestart=void 0,this._disX=0,this._coord={x:e.pageX,y:e.pageY}},move:function(t){if(!(t.touches.length>1||t.scale&&1!==t.scale)){var e,i=t.touches[0],s=this._disX=i.pageX-this._coord.x,n=this.left;"undefined"==typeof this._movestart&&(this._movestart=!!(this._movestart||Math.abs(s)<Math.abs(i.pageY-this._coord.y))),this._movestart||(t.preventDefault(),t.stopPropagation(),this.stop(),this.loop||(s/=!this.curIndex&&s>0||this.curIndex==this._maxpage&&0>s?Math.abs(s)/this.steps+1:1),e=n-this.curIndex*this.steps+s,this.setCoord(this.panel,e),this._disX=s)}},end:function(t){if(!this._movestart){var e=this._disX;-10>e?(t.preventDefault(),this.forward()):e>10&&(t.preventDefault(),this.backward()),e=null}},backward:function(t){t&&t.preventDefault&&t.preventDefault();var e=this.curIndex,i=this._minpage;e-=1,i>e&&(e=this.loop?i-1:i),this.slideTo(e),this.callback&&this.callback(Math.max(e,i),-1)},forward:function(t){t&&t.preventDefault&&t.preventDefault();var e=this.curIndex,i=this._maxpage;e+=1,e>i&&(e=this.loop?i+1:i),this.slideTo(e),this.callback&&this.callback(Math.min(e,i),1)},setCoord:function(t,e){this.useTransform&&t.css("-webkit-transform",r+e+"px,0"+a)||t.css("left",e)},slideTo:function(t,e){t=t||0,this.curIndex=t;var i=this.panel,s=i[0].style,n=this.left-t*this.steps;s.webkitTransitionDuration=s.MozTransitionDuration=s.msTransitionDuration=s.OTransitionDuration=s.transitionDuration=(e||this.duration)+"ms",this.setCoord(i,n),this.loadImg(t)},transitionEnd:function(){var t=this.panel,e=t[0].style,i=this.loop,s=this.curIndex;i&&(s>this._maxpage?this.curIndex=0:s<this._minpage&&(this.curIndex=this._maxpage),this.setCoord(t,this.left-this.curIndex*this.steps)),i||s!=this._maxpage?this.begin():(this.stop(),this.play=!1),this.update(),this.updateArrow(),e.webkitTransitionDuration=e.MozTransitionDuration=e.msTransitionDuration=e.OTransitionDuration=e.transitionDuration=0,this.onTransitionEnd&&this.onTransitionEnd.call(this)},update:function(){var t=this.triggers,e=this.activeTriggerCls,i=this.curIndex;t&&t[i]&&(this.triggerSel&&(this.triggerSel.className=""),t[i].className=e,this.triggerSel=t[i])},updateArrow:function(){var t=this.prev,e=this.next;if(t&&t.length&&e&&e.length&&!this.loop){var i=this.curIndex,s=this.activePnCls;0>=i&&t.addClass(s)||t.removeClass(s),i>=this._maxpage&&e.addClass(s)||e.removeClass(s)}},begin:function(){var t=this;t.play&&!t._playTimer&&(t.stop(),t._playTimer=setInterval(function(){t.forward()},t.interval))},stop:function(){var t=this;t.play&&t._playTimer&&(clearInterval(t._playTimer),t._playTimer=null)},destroy:function(){var t=this,e=t.wrap[0],s=t.prev,n=t.next,r=t.triggers;e.removeEventListener&&(e.removeEventListener("touchstart",t,!1),e.removeEventListener("touchmove",t,!1),e.removeEventListener("touchend",t,!1),e.removeEventListener("webkitTransitionEnd",t,!1),e.removeEventListener("msTransitionEnd",t,!1),e.removeEventListener("oTransitionEnd",t,!1),e.removeEventListener("transitionend",t,!1)),s&&s.length&&s.off("click"),n&&n.length&&n.off("click"),t.hasTrigger&&r&&r.each(function(t,e){i(e).off("click")})},attachTo:function(t,e){return t=i(t),t.each(function(t,i){i.getAttribute("l")||(i.setAttribute("l",!0),o.cache.push(new o(i,e)))})}}),o.cache=[],o.destroy=function(){var t=o.cache,e=t.length;if(!(1>e)){for(var i=0;e>i;i++)t[i].destroy();o.cache=[]}},e.Slider=o}(window,window.lib||(window.lib={}));