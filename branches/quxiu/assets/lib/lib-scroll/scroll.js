!function(t,e){function i(){e.scroll.outputDebugLog&&console.debug.apply(console,arguments)}function n(t){var e=t.getBoundingClientRect();if(!e){e={},e.width=t.offsetWidth,e.height=t.offsetHeight,e.left=t.offsetLeft,e.top=t.offsetTop;for(var i=t.offsetParent;i;)e.left+=i.offsetLeft,e.top+=i.offsetTop,i=i.offsetParent;e.right=e.left+e.width,e.bottom=e.top+e.height}return e}function r(t){return 0-t.options[t.axis+"Padding1"]}function o(t){var e=n(t.element),i=n(t.viewport),o=r(t);if("y"===t.axis)var s=0-e.height+i.height;else var s=0-e.width+i.width;return Math.min(s+t.options[t.axis+"Padding2"],o)}function s(t,e){return e>t.minScrollOffset?e-t.minScrollOffset:e<t.maxScrollOffset?e-t.maxScrollOffset:void 0}function a(t,e){return e>t.minScrollOffset?e=t.minScrollOffset:e<t.maxScrollOffset&&(e=t.maxScrollOffset),e}function l(t,e,n){i(t.element.scrollId,e,n);var r=u.createEvent("HTMLEvents");if(r.initEvent(e,!1,!0),r.scrollObj=t,n)for(var o in n)r[o]=n[o];t.element.dispatchEvent(r),t.viewport.dispatchEvent(r)}function f(t){var e,i={x:0,y:0},n=getComputedStyle(t.element).webkitTransform;return"none"!==n&&(e=n.match(/^matrix3d\((?:[-\d.]+,\s*){12}([-\d.]+),\s*([-\d.]+)(?:,\s*[-\d.]+){2}\)/)||n.match(/^matrix\((?:[-\d.]+,\s*){4}([-\d.]+),\s*([-\d.]+)\)$/))&&(i.x=parseFloat(e[1])||0,i.y=parseFloat(e[2])||0),i}function d(t,e){return t=parseFloat(t),e=parseFloat(e),0!=t&&(t+="px"),0!=e&&(e+="px"),g?"translate3d("+t+", "+e+", 0)":"translate("+t+", "+e+")"}function c(t,c){function u(t){return O||z?(t.preventDefault(),t.stopPropagation(),!1):!0}function g(t){O||z||setTimeout(function(){var e=document.createEvent("HTMLEvents");e.initEvent("niceclick",!0,!0),t.target.dispatchEvent(e)},300)}function x(t,i){M=null,clearTimeout(C),C=setTimeout(function(){M&&(M=null,e.animation.requestFrame(t))},i||400),M=t}function b(){if(k.enabled)if(z&&S(),c.useFrameAnimation)L&&L.stop(),L=null;else{var e=f(k);t.style.webkitTransform=d(e.x,e.y),t.style.webkitTransition="",M=null,clearTimeout(C)}}function w(){if(k.enabled){var i=f(k)[k.axis],n=s(k,i);if(n){var r=a(k,i);if(n>0?l(k,"y"===k.axis?"pulldownend":"pullrightend"):0>n&&l(k,"y"===k.axis?"pullupend":"pullleftend"),c.useFrameAnimation){var o=r-i;L=new e.animation(400,e.cubicbezier.ease,0,function(e,n){var r=(i+o*n).toFixed(2);t.style.webkitTransform="y"===k.axis?d(0,r):d(r,0),l(k,"scrolling")}),L.onend(S),L.play()}else{t.style.webkitTransition="-webkit-transform 0.4s ease 0";var u=r.toFixed(0);t.style.webkitTransform="y"===k.axis?d(0,u):d(u,0),x(S,400),e.animation.requestFrame(function(){z&&k.enabled&&(l(k,"scrolling"),e.animation.requestFrame(arguments.callee))})}}else z&&S()}}function y(t){k.enabled&&("y"!==k.axis&&t.isVertical||"x"===k.axis&&t.isVertical||(k.transformOffset=f(k),k.minScrollOffset=r(k),k.maxScrollOffset=o(k),H=2.5,A=!0,z=!0,q=!1,l(k,"scrollstart"),B=t["displacement"+k.axis.toUpperCase()]))}function F(e){if(k.enabled&&("y"===k.axis&&e.isVertical||"x"===k.axis&&!e.isVertical)){e.stopPropagation();var i=e["displacement"+k.axis.toUpperCase()];if(Math.abs(i-B)<5)return void e.stopPropagation();B=i;var n=k.transformOffset[k.axis]+i;n>k.minScrollOffset?(n=k.minScrollOffset+(n-k.minScrollOffset)/H,H*=1.003):n<k.maxScrollOffset&&(n=k.maxScrollOffset-(k.maxScrollOffset-n)/H,H*=1.003),H>4&&(H=4);var r=s(k,n);r&&(l(k,r>0?"y"===k.axis?"pulldown":"pullright":"y"===k.axis?"pullup":"pullleft",{boundaryOffset:Math.abs(r)}),k.options.noBounce&&(n=a(k,n))),t.style.webkitTransform="y"===k.axis?d(0,n.toFixed(2)):d(n.toFixed(2),0),l(k,"scrolling")}}function T(t){k.enabled&&("y"===k.axis&&t.isVertical||"x"===k.axis&&!t.isVertical)&&(t.stopPropagation(),t.isflick&&E(t))}function E(n){A=!0;var r,o,a,u,h,m,g,v,b,w,y,F,T,E,O,P,M;u=f(k)[k.axis];var C=s(k,u);if(!C){r=n["velocity"+k.axis.toUpperCase()];var H=2,B=.0015;c.inertia&&p[c.inertia]&&(H=p[c.inertia][0],B=p[c.inertia][1]),r>H&&(r=H),-H>r&&(r=-H),o=B*(r/Math.abs(r)),m=new e.motion({v:r,a:-o}),a=m.t,h=u+m.s;var V=s(k,h);if(V){i("惯性计算超出了边缘",V),g=r,v=o,V>0?(w=k.minScrollOffset,F=1):(w=k.maxScrollOffset,F=-1),y=new e.motion({v:F*g,a:-F*v,s:Math.abs(w-u)}),b=y.t;var W=y.generateCubicBezier();T=g-v*b,E=.03*(T/Math.abs(T)),M=new e.motion({v:T,a:-E}),O=M.t,P=w+M.s;{M.generateCubicBezier()}if(c.noBounce)if(i("没有回弹效果"),u!==w)if(c.useFrameAnimation){var I=w-u,R=e.cubicbezier(W[0][0],W[0][1],W[1][0],W[1][1]);L=new e.animation(b.toFixed(0),R,0,function(e,i){l(k,"scrolling",{afterFlick:!0});var n=u+I*i;t.style.webkitTransform="y"===k.axis?d(0,n.toFixed(2)):d(n.toFixed(2),0)}),L.onend(S),L.play()}else{t.style.webkitTransition="-webkit-transform "+(b/1e3).toFixed(2)+"s cubic-bezier("+W+") 0";var j=w.toFixed(0);t.style.webkitTransform="y"===k.axis?d(0,j):d(j,0),x(S,1e3*(b/1e3).toFixed(2))}else S();else if(u!==P)if(i("惯性滚动","s="+P.toFixed(0),"t="+((b+O)/1e3).toFixed(2)),c.useFrameAnimation){var I=P-u,R=e.cubicbezier.easeOut;L=new e.animation((b+O).toFixed(0),R,0,function(e,i){l(k,"scrolling",{afterFlick:!0});var n=u+I*i;t.style.webkitTransform="y"===k.axis?d(0,n.toFixed(2)):d(n.toFixed(2),0)}),L.onend(function(){if(k.enabled){var i=w-P,n=e.cubicbezier.ease;L=new e.animation(400,n,0,function(e,n){l(k,"scrolling",{afterFlick:!0});var r=P+i*n;t.style.webkitTransform="y"===k.axis?d(0,r.toFixed(2)):d(r.toFixed(2),0)}),L.onend(S),L.play()}}),L.play()}else{t.style.webkitTransition="-webkit-transform "+((b+O)/1e3).toFixed(2)+"s ease-out 0";var j=P.toFixed(0);t.style.webkitTransform="y"===k.axis?d(0,j):d(j,0),x(function(){if(k.enabled)if(i("惯性回弹","s="+w.toFixed(0),"t=400"),P!==w){t.style.webkitTransition="-webkit-transform 0.4s ease 0";var e=w.toFixed(0);t.style.webkitTransform="y"===k.axis?d(0,e):d(e,0),x(S,400)}else S()},1e3*((b+O)/1e3).toFixed(2))}else S()}else{i("惯性计算没有超出边缘");var D=m.generateCubicBezier();if(c.useFrameAnimation){var I=h-u,R=e.cubicbezier(D[0][0],D[0][1],D[1][0],D[1][1]);L=new e.animation(a.toFixed(0),R,0,function(e,i){l(k,"scrolling",{afterFlick:!0});var n=(u+I*i).toFixed(2);t.style.webkitTransform="y"===k.axis?d(0,n):d(n,0)}),L.onend(S),L.play()}else{t.style.webkitTransition="-webkit-transform "+(a/1e3).toFixed(2)+"s cubic-bezier("+D+") 0";var j=h.toFixed(0);t.style.webkitTransform="y"===k.axis?d(0,j):d(j,0),x(S,1e3*(a/1e3).toFixed(2))}}q=!0,c.useFrameAnimation||e.animation.requestFrame(function(){z&&q&&k.enabled&&(l(k,"scrolling",{afterFlick:!0}),e.animation.requestFrame(arguments.callee))})}}function S(){k.enabled&&(A=!1,setTimeout(function(){!A&&z&&(z=!1,q=!1,c.useFrameAnimation?(L&&L.stop(),L=null):t.style.webkitTransition="",l(k,"scrollend"))},50))}var k=this;if(c=c||{},c.noBounce=!!c.noBounce,c.padding=c.padding||{},c.isPrevent=null==c.isPrevent?!0:!!c.isPrevent,c.isFixScrollendClick=null==c.isFixScrollendClick?!0:!!c.isFixScrollendClick,c.padding?(c.yPadding1=-c.padding.top||0,c.yPadding2=-c.padding.bottom||0,c.xPadding1=-c.padding.left||0,c.xPadding2=-c.padding.right||0):(c.yPadding1=0,c.yPadding2=0,c.xPadding1=0,c.xPadding2=0),c.margin?(c.yMargin1=-c.margin.top||0,c.yMargin2=-c.margin.bottom||0,c.xMargin1=-c.margin.left||0,c.xMargin2=-c.margin.right||0):(c.yMargin1=0,c.yMargin2=0,c.xMargin1=0,c.xMargin2=0),c.direction=c.direction||"y",c.inertia=c.inertia||"normal",this.options=c,k.axis=c.direction,this.element=t,this.viewport=t.parentNode,this.plugins={},this.viewport.addEventListener("touchstart",b,!1),this.viewport.addEventListener("touchend",w,!1),this.viewport.addEventListener("touchcancel",w,!1),this.viewport.addEventListener("panstart",y,!1),this.viewport.addEventListener("pan",F,!1),this.viewport.addEventListener("panend",T,!1),this.element.scrollId=setTimeout(function(){h[k.element.scrollId+""]=k},1),c.isPrevent&&(this.viewport.addEventListener("touchstart",function(){v=!0},!1),k.viewport.addEventListener("touchend",function(){v=!1},!1)),c.isFixScrollendClick){var O,P;this.viewport.addEventListener("scrolling",function(){O=!0,P&&clearTimeout(P),P=setTimeout(function(){O=!1},400)},!1),this.viewport.addEventListener("click",u,!1),this.viewport.addEventListener("tap",g,!1)}if(c.useFrameAnimation){var L;Object.defineProperty(this,"animation",{get:function(){return L}})}else{var M,C=0;t.addEventListener("webkitTransitionEnd",function(t){if(M){var i=M;M=null,clearTimeout(C),e.animation.requestFrame(function(){i(t)})}},!1)}var H,z,q,A;Object.defineProperty(this,"isScrolling",{get:function(){return!!z}});var B,V={init:function(){return this.enable(),this.refresh(),this.scrollTo(0),this},enable:function(){return this.enabled=!0,this},disable:function(){var t=this.element;return this.enabled=!1,this.options.useFrameAnimation?this.animation&&this.animation.stop():e.animation.requestFrame(function(){t.style.webkitTransform=getComputedStyle(t).webkitTransform}),this},getScrollWidth:function(){return n(this.element).width},getScrollHeight:function(){return n(this.element).height},getScrollLeft:function(){return-f(this).x-this.options.xPadding1},getScrollTop:function(){return-f(this).y-this.options.yPadding1},getMaxScrollLeft:function(){return-k.maxScrollOffset-this.options.xPadding1},getMaxScrollTop:function(){return-k.maxScrollOffset-this.options.yPadding1},getBoundaryOffset:function(){return Math.abs(s(this,f(this)[this.axis])||0)},refresh:function(){var t=this.element,e="y"===this.axis,i=e?"height":"width";if(null!=this.options[i])t.style[i]=this.options[i]+"px";else if(t.childElementCount>0){var s,a,d=t.firstElementChild,c=t.lastElementChild;if(document.createRange&&(s=document.createRange(),s.selectNodeContents(t),a=n(s)),a)t.style[i]=a[i]+"px";else if(d&&c){for(;d&&0===n(d)[i]&&d.nextElementSibling;)d=d.nextElementSibling;for(;c&&c!==d&&0===n(c)[i]&&c.previousElementSibling;)c=c.previousElementSibling;t.style[i]=n(c)[e?"bottom":"right"]-n(d)[e?"top":"left"]+"px"}else t.style[i]="0"}else t.style[i]="auto",t.style[i]=n(t)[i]+"px";return this.transformOffset=f(this),this.minScrollOffset=r(this),this.maxScrollOffset=o(this),this.scrollTo(-this.transformOffset[this.axis]-this.options[this.axis+"Padding1"]),l(this,"contentrefresh"),this},offset:function(t){var e=n(this.element),i=n(t);if("y"===this.axis){var r={top:i.top-e.top-this.options.yPadding1,left:i.left-e.left,right:e.right-i.right,width:i.width,height:i.height};r.bottom=r.top+r.height}else{var r={top:i.top-e.top,bottom:e.bottom-i.bottom,left:i.left-e.left-this.options.xPadding1,width:i.width,height:i.height};r.right=r.left+r.width}return r},getRect:function(t){var e=n(this.viewport),i=n(t);if("y"===this.axis){var r={top:i.top-e.top,left:i.left-e.left,right:e.right-i.right,width:i.width,height:i.height};r.bottom=r.top+r.height}else{var r={top:i.top-e.top,bottom:e.bottom-i.bottom,left:i.left-e.left,width:i.width,height:i.height};r.right=r.left+r.width}return r},isInView:function(t){var e=n(this.viewport),i=this.getRect(t);return"y"===this.axis?e.top<i.bottom&&e.bottom>i.top:e.left<i.right&&e.right>i.left},scrollTo:function(t,i){var n=this,r=this.element;return t=-t-this.options[this.axis+"Padding1"],t=a(this,t),z=!0,i===!0?(r.style.webkitTransition="-webkit-transform 0.4s ease 0",x(S,400),e.animation.requestFrame(function(){z&&n.enabled&&(l(n,"scrolling"),e.animation.requestFrame(arguments.callee))})):(r.style.webkitTransition="",x(S,1)),r.style.webkitTransform="y"===this.axis?d(f(this).x,t):d(t,f(this).y),this},scrollToElement:function(t,e){var i=this.offset(t);return i=i["y"===this.axis?"top":"left"],this.scrollTo(i,e)},getViewWidth:function(){return n(this.viewport).width},getViewHeight:function(){return n(this.viewport).height},addPulldownHandler:function(t){var e=this;return this.element.addEventListener("pulldownend",function(i){e.disable(),t(i,function(){e.scrollTo(0,!0),e.enable()})},!1),this},addPullupHandler:function(t){var e=this;return this.element.addEventListener("pullupend",function(i){e.disable(),t(i,function(){e.scrollTo(e.getScrollHeight(),!0),e.enable()})},!1),this},addScrollstartHandler:function(t){return this.element.addEventListener("scrollstart",function(e){t(e)},!1),this},addScrollingHandler:function(t){return this.element.addEventListener("scrolling",function(e){t(e)},!1),this},addScrollendHandler:function(t){return this.element.addEventListener("scrollend",function(e){t(e)},!1),this},addEventListener:function(){this.element.addEventListener.apply(this.element,arguments)},removeEventListener:function(){this.element.removeEventListener.apply(this.element,arguments)},enablePlugin:function(t,e){var i=m[t];return i&&!this.plugins[t]&&(this.plugins[t]=!0,e=e||{},i.call(this,t,e)),this}};for(var W in V)this[W]=V[W];delete V}var u=t.document,h={},m={},p={normal:[2,.0015],slow:[1.5,.003],veryslow:[1.5,.005]},g="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,v=!1;u.addEventListener("touchmove",function(t){return v?(t.preventDefault(),!1):!0},!1),e.scroll=function(t,e){if(1===arguments.length&&!(arguments[0]instanceof HTMLElement))if(e=arguments[0],e.scrollElement)t=e.scrollElement;else{if(!e.scrollWrap)throw new Error("no scroll element");t=e.scrollWrap.firstElementChild}if(!t.parentNode)throw new Error("wrong dom tree");if(e&&e.direction&&["x","y"].indexOf(e.direction)<0)throw new Error("wrong direction");var i;return i=t.scrollId?h[t.scrollId]:new c(t,e)},e.scroll.plugin=function(t,e){return e?(t=t.split(","),void t.forEach(function(t){m[t]=e})):m[t]}}(window,window.lib||(window.lib={}));