!function(e,t){var n=e.document,i=(e.navigator.userAgent,window.requestAnimationFrame||window.webkitRequestAnimationFrame);proto={init:function(){function e(){if(l.scraping)for(var e=0;e<event.changedTouches.length;e++)t(event.changedTouches[e])}function t(e){function t(t){for(var n,i=0;i<t.changedTouches.length;i++)if(t.changedTouches[i].identifier==e.identifier){n=t.changedTouches[i];break}n&&(f&&d&&c.moveTo(f,d),o(n)&&(f=n.clientX-v.left,d=n.clientY-v.top,c.lineTo(f,d),c.stroke()),s.forceRefresh&&(h.style.opacity=h.style.opacity?"":.999))}function l(i){u=!1;for(var o,c=0;c<i.changedTouches.length;c++)if(i.changedTouches[c].identifier==e.identifier){o=i.changedTouches[c];break}o&&(r()>s.activePercent&&a(),n.removeEventListener("touchmove",t,!1),n.removeEventListener("touchend",l,!1))}var f,d,u=!0;n.addEventListener("touchmove",t,!1),n.addEventListener("touchend",l,!1),o(e)&&(f=e.clientX-v.left,d=e.clientY-v.top),c.beginPath(),i&&s.moveChecking&&i(function(){u&&(r()>s.activePercent?(a(),n.removeEventListener("touchmove",t,!1),n.removeEventListener("touchend",l,!1)):i(arguments.callee))})}function o(e){return e.clientX>v.left&&e.clientX<v.right&&e.clientY>v.top&&e.clientY<v.bottom}function r(){var e,t,n,i,o,r=d.querySelectorAll(".active-el"),a=0,l=0;0===r.length&&(r=d.querySelectorAll("*"));for(var s=0;s<r.length;s++)if(e=r[s].getClientRects()[0]){t=e.left-v.left,n=e.top-v.top,i=e.right-e.left,o=e.bottom-e.top,data=c.getImageData(t,n,i,o).data;for(var f=0;f<data.length;f+=4)a++,0==data[f+3]&&l++}return l/a}function a(){l.scraping=!1,h.style.webkitTransition="opacity 0.6s ease",h.style.opacity=0,setTimeout(function(){h.style.display="none",s.onfinish&&s.onfinish()},600)}var c,l=this,s=l.options,f=l.el="string"==typeof s.el?document.querySelector(s.el):s.el,h=l.canvas=document.createElement("canvas"),d=l.wrap=document.createElement("div"),v=l.region=f.getClientRects()[0];if(f.appendChild(d),f.appendChild(h),f.style.cssText+="position:relative;",h.width=v.right-v.left,h.height=v.bottom-v.top,d.style.cssText="width:100%;height:100%;position:relative;",h.style.cssText="width:"+h.width+"px;height:"+h.height+";position:absolute;top:0;left:0;z-index:9;display:none;",!(c=l.context=h.getContext("2d")))throw new Error("not support context 2d");n.addEventListener("touchstart",e,!1)},replace:function(e){{var t=this,n=t.wrap;t.canvas}if(e instanceof HTMLElement&&(e=[e]),n.style.visibility="hidden","string"==typeof e)n.innerHTML=e;else if(e instanceof Array){n.innerHTML="";for(var i=0;i<e.length;i++)n.appendChild(e[i])}n.style.visibility=""},refresh:function(e){var t=this,n=(t.el,t.wrap),i=t.options,o=t.canvas,r=t.region,a=t.context;e||(e={});for(var c in e)i[c]=e[c];if(n.style.visibility="hidden",o.width=r.right-r.left,a.globalCompositeOperation="source-over",a.fillStyle=i.coverColor,a.fillRect(0,0,r.right-r.left,r.bottom-r.top),i.font){if(a.font=i.font.size+" "+(i.font.family||"serif"),a.fillStyle=i.font.color,"center"===i.font.x||"center"===i.font.y){var l=a.measureText(i.font.text);"center"===i.font.x&&(i.font.x=o.width/2-l.width/2),"center"===i.font.y&&(i.font.y=o.height/2-l.height/2)}a.fillText(i.font.text,i.font.x||0,i.font.y||0)}a.globalCompositeOperation="destination-out",a.lineJoin="round",a.lineCap="round",a.strokeStyle="rgba(0,0,0,255)",a.lineWidth=i.lineWidth||30,o.style.opacity=1,o.style.webkitTransition="",o.style.display="",n.style.visibility="",this.scraping=!0}},t.scrape=function(e){var t=Object.create({});e.activePercent||(e.activePercent=.8),t.options=e;for(var n in proto)t[n]=proto[n];return t.init(),t}}(window,window.lib||(window.lib={}));