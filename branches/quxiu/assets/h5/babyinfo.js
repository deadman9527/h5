!function(e,t){function a(e,t){if(r={},r[e])return void t(r[e]);var a=[];if(1==e){for(var n=0;n<parseInt(endDates[0])-parseInt(startDates[0])+1;n++){var s=new Object;s.name=n+parseInt(startDates[0])+"年",s.id=n+2,a.push(s)}t(a),r[e]=a}if(e>=2&&19>=e){if(endDates[0]==startDates[0]){d=!0;for(var n=parseInt(startDates[1])-1;n<parseInt(endDates[1]);n++){var s=new Object;s.name=n+1+"月",s.id=n+21,a.push(s)}}else if(2==e){d=!1;for(var n=parseInt(startDates[1])-1;12>n;n++){var s=new Object;s.name=n+1+"月",s.id=n+21,a.push(s)}}else if(e==2+parseInt(endDates[0])-parseInt(startDates[0])){console.log("lastYear"),d=!0;for(var n=0;n<parseInt(endDates[1]);n++){var s=new Object;s.name=n+1+"月",s.id=n+21,a.push(s)}}else{d=!1;for(var n=0;12>n;n++){var s=new Object;s.name=n+1+"月",s.id=n+21,a.push(s)}}t(a),r[e]=a}if(e>=21&&32>=e){var i=30;if(22==e?i=28:(21==e||23==e||25==e||27==e||28==e||30==e||32==e)&&(i=31),endDates[0]==startDates[0])if(21==e)for(var n=parseInt(startDates[2])-1;i>n;n++){var s=new Object;s.name=n+1+"日",s.id=n+41,a.push(s)}else if(e==21+parseInt(endDates[1])-parseInt(startDates[1]))for(var n=0;n<parseInt(endDates[2]);n++){var s=new Object;s.name=n+1+"日",s.id=n+41,a.push(s)}else for(var n=0;i>n;n++){var s=new Object;s.name=n+1+"日",s.id=n+41,a.push(s)}else if(d&&e==21+parseInt(endDates[1])-parseInt(startDates[1]))for(var n=0;n<parseInt(endDates[2]);n++){var s=new Object;s.name=n+1+"日",s.id=n+41,a.push(s)}else if(21!=e||d)for(var n=0;i>n;n++){var s=new Object;s.name=n+1+"日",s.id=n+41,a.push(s)}else for(var n=parseInt(startDates[2])-1;i>n;n++){var s=new Object;s.name=n+1+"日",s.id=n+41,a.push(s)}t(a),r[e]=a}}function n(e){var t={},n={},s=e.id||1,i=e.deep||3,r=e.onReady,d={3:"year",2:"month",1:"day"};o=e.startDate||o,l=e.endDate||l,startDates=o.split("-"),endDates=l.split("-"),a(s,function(e){var s=d[i];n[s]=[],e.forEach(function(e,a){var i={key:e.name,value:e.id,selected:0===a};n[s].push(i),0===a&&(t[s]=i)}),i--,1>i?r&&r(n):a(t[s].value,arguments.callee)})}function s(e,t){t=t||{};var a=ctrl.selectmenu;i=new a({confirmText:t.confirmText||"确定",title:t.title||"",cancelText:t.opts||"取消",trigger:t.trigger}),i.viewModel=e,i.addEventListener("confirm",function(){t.onConfirm(this.selectedValue)}),i.addEventListener("select",function(e){var t=this.selectedValue["val-"+e],a=this;"year"==e?n({id:t,deep:2,onReady:function(e){a.linkage("month",e.month),a.linkage("day",e.day)}}):"month"==e&&n({id:t,deep:1,onReady:function(e){a.linkage("day",e.day)}})}),t.appendDom?t.appendDom.appendChild(i.root):document.body.appendChild(i.root)}var i,r={},o="2010-1-1",l="2016-1-1",d=!1;t.selectAddress={init:function(e){console.log(e),n({onReady:function(t){s(t,e)},startDate:e.startDate,endDate:e.endDate})}}}(Zepto,window.app||(window.app={})),function(e,t){function a(e,t){if(r={},r[e])return void t(r[e]);var a=[];if(1==e){for(var n=0;n<parseInt(endDates[0])-parseInt(startDates[0])+1;n++){var s=new Object;s.name=n+parseInt(startDates[0])+"年",s.id=n+2,a.push(s)}t(a),r[e]=a}if(e>=2&&19>=e){if(endDates[0]==startDates[0]){d=!0;for(var n=parseInt(startDates[1])-1;n<parseInt(endDates[1]);n++){var s=new Object;s.name=n+1+"月",s.id=n+21,a.push(s)}}else if(2==e){d=!1;for(var n=parseInt(startDates[1])-1;12>n;n++){var s=new Object;s.name=n+1+"月",s.id=n+21,a.push(s)}}else if(e==2+parseInt(endDates[0])-parseInt(startDates[0])){console.log("lastYear"),d=!0;for(var n=0;n<parseInt(endDates[1]);n++){var s=new Object;s.name=n+1+"月",s.id=n+21,a.push(s)}}else{d=!1;for(var n=0;12>n;n++){var s=new Object;s.name=n+1+"月",s.id=n+21,a.push(s)}}t(a),r[e]=a}if(e>=21&&32>=e){var i=30;if(22==e?i=28:(21==e||23==e||25==e||27==e||28==e||30==e||32==e)&&(i=31),endDates[0]==startDates[0])if(21==e)for(var n=parseInt(startDates[2])-1;i>n;n++){var s=new Object;s.name=n+1+"日",s.id=n+41,a.push(s)}else if(e==21+parseInt(endDates[1])-parseInt(startDates[1]))for(var n=0;n<parseInt(endDates[2]);n++){var s=new Object;s.name=n+1+"日",s.id=n+41,a.push(s)}else for(var n=0;i>n;n++){var s=new Object;s.name=n+1+"日",s.id=n+41,a.push(s)}else if(d&&e==21+parseInt(endDates[1])-parseInt(startDates[1]))for(var n=0;n<parseInt(endDates[2]);n++){var s=new Object;s.name=n+1+"日",s.id=n+41,a.push(s)}else if(21!=e||d)for(var n=0;i>n;n++){var s=new Object;s.name=n+1+"日",s.id=n+41,a.push(s)}else for(var n=parseInt(startDates[2])-1;i>n;n++){var s=new Object;s.name=n+1+"日",s.id=n+41,a.push(s)}t(a),r[e]=a}}function n(e){var t={},n={},s=e.id||1,i=e.deep||3,r=e.onReady,d={3:"year",2:"month",1:"day"};o=e.startDate||o,l=e.endDate||l,startDates=o.split("-"),endDates=l.split("-"),a(s,function(e){var s=d[i];n[s]=[],e.forEach(function(e,a){var i={key:e.name,value:e.id,selected:0===a};n[s].push(i),0===a&&(t[s]=i)}),i--,1>i?r&&r(n):a(t[s].value,arguments.callee)})}function s(e,t){t=t||{};var a=ctrl.selectmenu;i=new a({confirmText:t.confirmText||"确定",title:t.title||"",cancelText:t.opts||"取消",trigger:t.trigger}),i.viewModel=e,i.addEventListener("confirm",function(){t.onConfirm(this.selectedValue)}),i.addEventListener("select",function(e){var t=this.selectedValue["val-"+e],a=this;"year"==e?n({id:t,deep:2,onReady:function(e){a.linkage("month",e.month),a.linkage("day",e.day)}}):"month"==e&&n({id:t,deep:1,onReady:function(e){a.linkage("day",e.day)}})}),t.appendDom?t.appendDom.appendChild(i.root):document.body.appendChild(i.root)}var i,r={},o="2010-1-1",l="2016-1-1",d=!1;t.selectAddress={init:function(e){console.log(e),n({onReady:function(t){s(t,e)},startDate:e.startDate,endDate:e.endDate})}}}(Zepto,window.app2||(window.app2={})),function(e){var t=new Date,a=t.getDate(),n=t.getMonth()+1,s=t.getFullYear(),i=new Date((new Date).getTime()+2592e7),r=(i.getDate(),i.getMonth()+1),o=i.getFullYear();String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};var l={init:function(){var t=new lib.httpurl(location.href),a=t.params;this.type=a.type;var n=1==this.type?"妈妈信息":"宝宝信息";document.title=n,this.babyId=a.babyId||null,this.birthday=a.birthday||null,this.sextype=a.sex||null,this.evalType=this.babyId?"update":"add",1==this.type?(e("#mother").show(),e("#baby").hide(),this.nickName=a.name||"",1==this.sextype?(e("#mother_status").html("王子"),e("#motherData").html("出生日期：")):2==this.sextype?(e("#mother_status").html("公主"),e("#motherData").html("出生日期：")):3==this.sextype&&(e("#mother_status").html("孕育中"),e("#motherData").html("预产期：")),e("#motherAge").val(this.birthday),e("#mother_username").val(this.nickName)):(e("#baby").show(),e("#mother").hide(),this.name=a.name||"",1==this.sextype?(e("#sex").val("王子"),e("#babyDate").html("出生日期：")):2==this.sextype?(e("#sex").val("公主"),e("#babyDate").html("出生日期：")):3==this.sextype&&(e("#sex").val("孕育中"),e("#babyDate").html("预产期：")),e("#username").val(this.name),this.birthday&&e("#babyAge").val(this.birthday)),new ctrl.topBar({isIndex:!1,title:n}),this.render()},render:function(){{var t=this;document.getElementById(1==this.type?"motherAge":"babyAge"),e(1==this.type?"#motherAge":"#babyAge")}if(2==t.type){var a=ctrl.selectmenu,n=document.querySelector("#sex"),s=new a({confirmText:"确定",title:"性别",cancelText:"取消",trigger:n});s.viewModel={age:[{key:"王子",value:"1"},{key:"公主",value:"2"},{key:"孕育中",value:"3"}]},s.addEventListener("confirm",function(){n.value=this.selectedValue["key-age"],t.babyType=this.selectedValue["val-age"],t.sextype=this.selectedValue["val-age"],e("#cli_dialog").remove(),e(".ctrl-selectmenu:eq(1)").remove(),t.selectTime()}),s.addEventListener("cancel",function(){}),document.body.appendChild(s.root);var t=this;e(".save-btn").click(function(){t.submit()})}else{var a=ctrl.selectmenu,n=document.querySelector("#mother_status"),s=new a({confirmText:"确定",title:"状态",cancelText:"取消",trigger:n});s.viewModel={age:[{key:"王子",value:"1"},{key:"公主",value:"2"},{key:"孕育中",value:"3"}]},s.addEventListener("confirm",function(){console.log(this.selectedValue),e("#motherData").html(3!=this.selectedValue["val-age"]?"出生日期：":"预产期："),e("#mother_status").html(this.selectedValue["key-age"]),t.babyType=this.selectedValue["val-age"],t.sextype=this.selectedValue["val-age"],e("#cli_dialog").remove(),e(".ctrl-selectmenu:eq(1)").remove(),t.selectTime()}),s.addEventListener("cancel",function(){}),document.body.appendChild(s.root);var t=this;e(".save-btn").click(function(){t.submit()})}this.selectTime()},selectTime:function(){var t=this,i=document.getElementById(1==this.type?"motherAge":"babyAge"),l=e(1==this.type?"#motherAge":"#babyAge");3==t.sextype?(e("#babyDate").html("预产期："),app.selectAddress.init({confirmText:"",title:"预产期",cancelText:"",startDate:s+"-"+n+"-"+a,endDate:o+"-"+r+"-"+a,trigger:i,onConfirm:function(e){l.css("color","#333"),l.val(parseInt(e["key-year"])+"-"+parseInt(e["key-month"])+"-"+parseInt(e["key-day"])),t.birthday=parseInt(e["key-year"])+"-"+parseInt(e["key-month"])+"-"+parseInt(e["key-day"])}})):(e("#babyDate").html("出生日期："),app.selectAddress.init({confirmText:"",title:"出生日期",cancelText:"",startDate:"2001-1-1",endDate:s+"-"+n+"-"+a,trigger:i,onConfirm:function(e){l.css("color","#333"),l.val(parseInt(e["key-year"])+"-"+parseInt(e["key-month"])+"-"+parseInt(e["key-day"])),t.birthday=parseInt(e["key-year"])+"-"+parseInt(e["key-month"])+"-"+parseInt(e["key-day"])}}))},submit:function(){var e=this;if(e.verify()&&!e.isAjax){console.log(e);var t="add"==e.evalType?"":e.babyId;if(1==e.type&&e.nickName){var a=e.nickName,n="",s="evalUserBaby";e.evalType=""}else{var a="";n=e.name;var s="evalbaby"}e.isAjax=!0,lib.api.get({needLogin:!0,api:{c:"user",a:s},data:{evalType:e.evalType,birthday:e.birthday,name:n,sex:e.sextype,babyId:t,nickName:a},success:function(t){t.data&&t.data.user&&lib.storage.set("guideFilter",parseInt(t.data.user.filter)),1==e.type&&lib.storage.set("nickName",e.nickName),location.href="personinfo.html",console.log(t)},error:function(e){e&&e.desc&&(console.log(e.desc),lib.notification.alert(e.desc,function(){this.hide()}).show()),console.error(e)},complete:function(){e.isAjax=!1}})}},verify:function(){if(1==this.type){if(this.nickName=e("#mother_username").val(),this.nickName=this.nickName.trim(),0==this.nickName.length)return lib.notification.simple("妈咪名称不能为空","",1e3),!1;if(this.nickName.length>12)return lib.notification.simple("妈咪名称不能超过12个字符","",1e3),!1}else{if(this.name=e("#username").val(),this.name=this.name.trim(),0==this.name.length)return lib.notification.simple("宝贝名称不能为空","",1e3),!1;if(this.name.length>12)return lib.notification.simple("宝贝名称不能超过12个字符","",1e3),!1}return this.sextype?this.birthday?!0:(lib.notification.simple("日期不能为空","",1e3),!1):(lib.notification.simple("性别不能为空","",1e3),!1)}};e(function(){l.init()})}(Zepto,window.Global||(window.Global={}));